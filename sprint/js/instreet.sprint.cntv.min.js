(function(q,s){if(typeof q.InstreetWidget!="undefined"||q.InstreetWidget!=null){return null}else{q.InstreetWidget={version:"@REVISION@",name:"InstreetWidget"}}var u=q.document,navigator=q.navigator,location=q.location,isIE=!!q.ActiveXObject,imgs=[],B=[],isFirst=true;var v="http://push.instreet.cn/";var z={redurl:v+"click.action",callbackurl:v+"push.action",murl:v+"tracker.action",iurl:v+"tracker90.action",ourl:v+"loadImage.action",surl:v+"share/weiboshare",cssurl:'http://static.instreet.cn/widgets/push/css/instreet.sprint.min.css',imih:300,imiw:300,timer:1000,width:250,height:250};var A={bind:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}else{a["on"+b]=c}},remove:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else if(a.datachEvent){a.datachEvent("on"+b,c)}else{a["on"+b]=null}},getEvent:function(a){return a?a:q.event},getTarget:function(a){return a.target||a.srcElement},stopPropagation:function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},getRelatedTarget:function(a){if(a.relatedTarget){return a.relatedTarget}else if(a.type=="mouseover"){return a.fromElement}else if(a.type=="mouseout"){return a.toElement}else{return null}},getXY:function(a){var x=0,y=0;if(a.getBoundingClientRect){var b=a.getBoundingClientRect();var D=u.documentElement;x=b.left+Math.max(D.scrollLeft,u.body.scrollLeft)-D.clientLeft;y=b.top+Math.max(D.scrollTop,u.body.scrollTop)-D.clientTop}else{for(;a!=u.body;x+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent){}};return{x:x,y:y}},aTrim:function(c){var d=new Array();c.sort(sortNum);var e=c.length,flag=0;for(var i=0;i<e;i++){if(c[i]!=c[i+1]){d[flag]=c[i];flag++}}return d;function sortNum(a,b){return a-b}},$:function(a,b,c){var d=a||u;if(u.getElementsByClassName)return d.getElementsByClassName(c);var e=[];var f=b||'*';f=f.toUpperCase();var g=d.getElementsByTagName(f);for(var l=g.length,i=l;i--;){var h=g[i];if(h.className){var k=h.className.replace(/\s/g,'|').split('|');for(var m=k.length,j=m;j--;){if(k[j]==c){e.push(h);break}}}}return e},importFile:function(a,b){var c;switch(a){case"js":c=u.createElement('script');c.src=b;c.charset="utf-8";c.type="text/javascript";break;case"css":c=u.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=b;break}var d=u.getElementsByTagName('head')[0];d.appendChild(c)},isVisible:function(a){if(a==u)return true;if(!a)return false;if(!a.parentNode)return false;if(a.style){if(a.style.display=='none')return false;if(a.style.visibility=='hidden')return false}if(q.getComputedStyle){var b=q.getComputedStyle(a,"");if(b.display=='none')return false;if(b.visibility=='hidden')return false}var b=a.currentStyle;if(b){if(b['display']=='none')return false;if(b['visibility']=='hidden')return false}return A.isVisible(a.parentNode)}};var $=function(a){return u.getElementById(a)},each=function(a,b){if(a.length){for(var i=0,len=a.length;i<len;i++){b.call(a[i],i)}}else{b.call(a,0)}},hide=function(a){each(a,function(){this.style.display="none"})},show=function(a){each(a,function(){this.style.display="block"})};var B=[];var C=function(){for(var i=0;i<B.length;i++)B[i]&&B[i]()};var E=function(){try{u.documentElement.doScroll('left')}catch(err){setTimeout(E,1);return}C()};var F=function(a){var b=!!q.ActiveXObject;if(u.readyState==="complete"){B.push(a);C();return}if(B.push(a)>1)return;if(u.addEventListener)return u.addEventListener('DOMContentLoaded',C,false);if(b){E()}};var G={get:function(a,b){var c;if(b=="float"){u.defaultView?b='cssFloat':b='styleFloat'}if(b=="opacity"){u.defaultView?b='opacity':b='filter'}if(u.defaultView&&u.defaultView.getComputedStyle){var c=u.defaultView.getComputedStyle(a,null)[b]}else if(a.currentStyle){c=a.currentStyle[b];if(b=="filter"){if(c.match("alpha")){c=parseFloat(c.match(/\d+/)[0])/100}else if(!c){c=1}}}typeof c=="string"&&c.match("px")?c=parseInt(c.replace("px","")):c;b=="opacity"?c=parseInt(c):c;return c},set:function(a,b,c){if(b=="float"){u.defaultView?b='cssFloat':b='styleFloat'}if(b=="opacity"){a.style.filter="alpha(opacity="+c*100+")";a.style.zoom=1}a.style[b]=c}};var H=(function(){var j=[],timerId;var k=function(a){for(var b in a){return false}return true};var l=function(a,b,c,d,e){var f=l.getOpt(c,d,e);if(a&&a.nodeType==1){var g,to;if(b&&typeof b=="object"){if(k(b)){e.call(a)}else{for(var h in b){var i=new m(a,f,h);g=G.get(a,h);end=parseFloat(b[h]);i.custom(g,end)}}}}};l.getOpt=function(a,b,c){var d={duration:a||200,easing:b||"linear"};d.callback=function(){c&&c()};return d};l.stop=function(a,b){b=b||false;for(var i=j.length;i--;){var c=j[i];if(c.elem===a){if(b){c.update(c.name,c.end)}j.splice(i,1)}}};var m=function(a,b,c){this.elem=a;this.options=b;this.name=c};m.prototype.custom=function(a,b){this.startTime=new Date().getTime();this.start=a;this.end=b;j.push(this);m.tick()};m.prototype.step=function(){var a=new Date().getTime(),nowPos;if(a>this.options.duration+this.startTime){nowPos=this.end;this.options.callback.call(this.elem);this.stop()}else{var n=a-this.startTime;var b=n/this.options.duration;var c=o[this.options.easing](b,0,1,this.options.duration);nowPos=this.start+((this.end-this.start)*c)}this.update(this.name,nowPos)};m.prototype.stop=function(){for(var i=j.length;i--;){if(j[i]===this){j.splice(i,1)}}};m.prototype.update=function(a,b){if(a!="opacity"){b+="px"}G.set(this.elem,a,b)};m.tick=function(){if(timerId)return;timerId=setInterval(function(){for(var i=0,len=j.length;i<len;i++){j[i]&&j[i].step()}if(!j.length){m.stop()}},13)};m.stop=function(){clearInterval(timerId);timerId=null};var o={linear:function(p){return p},swing:function(p){return(-Math.cos(p*Math.PI)/2)+0.5}};return l})();var I=(function(){var b=null;return function(a){b=setInterval(function(){for(var i=0;i<a.length;i++){a[i]&&a[i].detect()}},500)}})();var J={adsArray:[],initData:function(){var a=u.getElementsByTagName('img');for(var i=0,len=a.length;i<len;i++){var b=a[i];imgs[i]=b;b.insId=i;b.setAttribute("instreet_img_id",i);J.onImgLoad(b)}},onImgLoad:function(b){var c=new Image();c.src=b.src,c.insId=b.insId;if(c.complete){J.loadData(c)}else{c.onload=function(){var a=this;a.onload=null;J.loadData(c)}}},loadData:function(a){var b=a.insId,clientImg=imgs[b];if(a.width>=z.imiw&&a.height>=z.imih){if(clientImg.clientWidth>=z.imiw&&clientImg.clientHeight>=z.imih||(clientImg.clientWidth==0&&clientImg.clientHeight==0)){if(typeof z.adsLimit=="number"&&z.adsLimit<=0){return}clientImg.setAttribute('instreet_data_loading',true);clientImg.insDataLoading=true;M.recordImage(clientImg);J.createJsonp(clientImg);z.adsLimit&&z.adsLimit--}}},createJsonp:function(a){var w=z.width||250,h=z.height||250;var b=encodeURIComponent(encodeURIComponent(a.src)),url=z.callbackurl+"?index="+a.insId+"&pd="+z.widgetSid+"&iu="+b+"&callback=insjsonp"+"&w="+w+"&h="+h;A.importFile('js',url)}};q['insjsonp']=function(a){if(a){var b=a.index,img=imgs[b];img.insDataLoaded=true;img.setAttribute('instreet_data_loaded',true);var c=new M(a,L.container);K(b);J.adsArray[b]=c}};var K=function(a){var b=J.adsArray[a];if(b&&b.adWrapper){var c=b.adWrapper,parent=c.parentNode;parent&&parent.removeChild(c);for(var i=0,len=b.spotsArray.length;i<len;i++){var p=b.spotsArray[i].parentNode;p&&p.removeChild(b.spotsArray[i])}}};var L={init:function(){var a=z.cssurl;A.importFile('css',a);L.createContainer()},createContainer:function(){var a=u.createElement('div'),spotBox=u.createElement('div');a.id="instreet-plugin-container";spotBox.id="instreet-plugin-spotbox";L.container=a;L.spotBox=spotBox;a.appendChild(spotBox);u.body.children&&u.body.insertBefore(a,u.body.firstChild)}};var M=function(a,b){var c=imgs[a.index];this.data=a;this.container=b;this.img=c;this.originInfo={width:c.clientWidth,height:c.clientHeight,src:c.src,pos:A.getXY(c)};this.spotsArray=[];this.timerId=null;this.init()};M.prototype={constructor:M,isFirstApp:true,init:function(){var a=this;a.createApps();a.locate();a.bindEvents()},createApps:function(){var a=this;var b=u.createElement("div"),tabWrapper=u.createElement("ul"),contentWrapper=u.createElement("ul");if(z.position==0){b.className="in-ad-wrapper in-position-right"}else if(z.position==1){b.className="in-ad-wrapper in-position-left"}if(z.color){b.className+=" in-"+z.color+"style"}if(z.width){b.className+=" in-size"+z.width}tabWrapper.className="in-tabs-wrapper";contentWrapper.className="in-contents-wrapper";contentWrapper.style.width="0";var c=u.createDocumentFragment(),contFrag=u.createDocumentFragment();var d=['weiboApp','adApp','shopApp','newsApp','wikiApp','weatherApp','shareApp'];for(var i=0,len=d.length;i<len;i++){var e=d[i];if(typeof M.modules[e]=='function'){var f=M.modules[e](a);if(f){f.tab&&c.appendChild(f.tab);f.cont&&contFrag.appendChild(f.cont)}}}tabWrapper.appendChild(c);contentWrapper.appendChild(contFrag);b.appendChild(tabWrapper);b.appendChild(contentWrapper);a.container.appendChild(b);a.adWrapper=b;a.tabs=tabWrapper;a.contents=contentWrapper},createSpot:function(a,b){var c=a.width,metrix=a.metrix,spot=u.createElement("a"),spotContainer=$("instreet-plugin-spotbox");spot.href="javascript:;";spot.index=b;spot.target="_self";spot.metrix=metrix;spot.imgWidth=c;if(a.adsType)spot.className="instreet-shopSpot";else if(a.type.toString()=="1"||a.type.toString()=="2")spot.className="instreet-weiboSpot";else if(a.type.toString()=="4")spot.className="instreet-wikiSpot";this.spotsArray.push(spot);spotContainer.appendChild(spot)},locate:function(){var b=this,img=b.img,pos=A.getXY(img),w=img.offsetWidth,left=(pos.x+w)+"px",right=(Math.max(u.body.clientWidth,u.documentElement.clientWidth)-pos.x)+'px',top=pos.y+"px",spotsArray=b.spotsArray;var c=b.isSlideLeft();var d=A.isVisible(img)&&img.clientWidth>=z.imiw&&img.clientHeight>=z.imih?"block":"none";function setFloat(a){if(isIE){b.tabs.style.styleFloat=a;b.contents.style.styleFloat=a}else{b.tabs.style.cssFloat=a;b.contents.style.cssFloat=a}};if(z.position==0){if(c){setFloat("right");b.contents.className="in-contents-wrapper in-contents-slideleft";b.adWrapper.style.left="auto";b.adWrapper.style.right=(Math.max(u.body.clientWidth,u.documentElement.clientWidth)-pos.x-w-26)+"px"}else{setFloat("left");b.contents.className="in-contents-wrapper";b.adWrapper.style.right="auto";b.adWrapper.style.left=left}}else if(z.position==1){if(c){setFloat("right");b.contents.className="in-contents-wrapper";b.adWrapper.style.right=right;b.adWrapper.style.left="auto"}else{setFloat("left");b.contents.className="in-contents-wrapper in-contents-slideright";b.adWrapper.style.left=(pos.x-26)+"px";b.adWrapper.style.right="auto"}}b.adWrapper.style.top=top;b.adWrapper.style.display=d;if(d=='block'&&z.footAuto&&b.isFirst!=false){b.isFirst=false;b.showApp();b.recordShow(9)}if(spotsArray.length>0){var e=spotsArray[0].imgWidth,zoomNum=img.width/e,r=15;for(var j=spotsArray.length;j--;){var f=spotsArray[j];metrix=f.metrix,ox=metrix%3000,oy=Math.round(metrix/3000),x=ox*zoomNum,y=oy*zoomNum;f.style.cssText="top:"+(y+pos.y-r)+"px;left:"+(x+pos.x-r)+"px;display:"+d}}},bindEvents:function(){var c=this,list=c.tabs.children,contents=c.contents.children;c.bindImgEvents(c.img);c.tabs.onmouseover=function(){clearTimeout(c.timerId)};c.tabs.onmouseout=function(){c.timerId=setTimeout(function(){c.closeApp()},z.timer)};c.contents.onmouseover=function(){clearTimeout(c.timerId)};c.contents.onmouseout=function(){c.timerId=setTimeout(function(){c.closeApp()},z.timer)};c.contents.onclick=function(e){var a=A.getEvent(e),tar=A.getTarget(a);if(tar.className=='in-close'){c.closeApp();if(z.position==0&&c.isLeft||z.position==1&&!c.isLeft){c.notopen=true}}else if(tar.parentNode.className=="in-share-icons"){c.shareImg(tar)}A.stopPropagation(a)};var d=A.$(c.contents,null,'in-shop-selector')[0];d&&each(d.children,function(a){var b=this;b.onclick=function(){M.chooseItem(this,a)}});var f=A.$(c.contents,null,'in-weibo-selector')[0];f&&each(f.children,function(a){var b=this;b.onclick=function(){M.chooseItem(this,a)}});var g=A.$(c.contents,null,'in-wiki-selector')[0];g&&each(g.children,function(a){var b=this;b.onclick=function(){M.chooseItem(this,a)}});for(var i=0,len=list.length;i<len;i++){var h=list[i],content=contents[i];h.onmouseover=function(){if(this.className.match(" focus")){return}var a=this.lastChild.className;c.showApp(this);if(a=="ad"||a=="shop"){c.recordShow(9)}};content.onmouseover=function(e){var a=A.getEvent(e),tar=A.getRelatedTarget(a);show(this);if(!this.contains(tar)){c.recordWatch(this)}}}for(var j=0,l=c.spotsArray.length;j<l;j++){var k=c.spotsArray[j];k.onmouseover=function(){clearTimeout(c.timerId);switch(this.className){case"instreet-shopSpot":var a=A.$(c.tabs,null,'shop')[0].parentNode,sel=A.$(c.contents,null,'in-shop-selector')[0].children[this.index];var b;if(sel){b=sel.className.match(" focus")}else{b=a.className.match(" focus")}sel&&M.chooseItem(sel,this.index);c.showApp(a);if(!b){c.recordShow(9)}break;case"instreet-weiboSpot":var a=A.$(c.tabs,null,'weibo')[0].parentNode,sel=A.$(c.contents,null,'in-weibo-selector')[0].children[this.index];sel&&M.chooseItem(sel,this.index);c.showApp(a);break;case"instreet-wikiSpot":var a=A.$(c.tabs,null,'wiki')[0].parentNode;sel=A.$(c.contents,null,'in-wiki-selector')[0].children[this.index];sel&&M.chooseItem(sel,this.index);c.showApp(a);break}}}},bindImgEvents:function(a){var b=this;A.bind(a,'mouseover',function(){clearTimeout(b.timerId);if(b.notopen){return}if(b.contents.offsetWidth==0){b.showApp();b.recordShow(10)}});A.bind(a,'mouseout',function(){b.timerId=setTimeout(function(){b.closeApp()},z.timer);b.notopen=false})},hideApps:function(){var a=this,list=a.tabs.children;for(var j=list.length;j--;){if(list[j].className.match("focus")){list[j].className=list[j].className.replace(" focus","")}}if(isIE){hide(a.contents.children)}else{each(a.contents.children,function(){this.style.cssText="display:block;visibility:hidden;height:0;overflow:hidden;"})}if(a.adWrapper.style.width!="auto"){a.adWrapper.style.width="auto"}},closeApp:function(){this.hideApps();this.contents.style.width=0},showApp:function(a){var b=this,list=b.tabs.children,type,app,width;if(list.length==0){return}if(!a){if(list[0].lastChild&&list[0].lastChild.className=='weibo'){a=list[1]}else{a=list[0]}}type=a.lastChild.className;b.hideApps();if(b.adWrapper.style.width=="auto"){b.adWrapper.style.width=(z.width+42)+'px'}a.className+=" focus";if(isIE){show(A.$(b.contents,'li',type))}else{each(A.$(b.contents,'li',type),function(){this.style.cssText="display:block;visibility:visible;height:auto;"})}width=(z.width+16)+"px";if(G.get(b.contents,'width')==0){H(b.contents,{width:width},200,'linear')}},getSelectedIndex:function(a){var b='in-'+a+'-selector',sels=A.$(this.contents,null,b)[0]?A.$(this.contents,null,b)[0].children:[];for(var j=0,len=sels.length;j<len;j++){if(sels[j].className.match(" focus")){return j}}return 0},shareImg:function(a){var b=this,picUrl=encodeURIComponent(b.img.src),shareTo=a.className.replace("-ico",""),widgetSid=b.data.widgetSid,time=new Date().getTime(),title=encodeURIComponent(u.title),url=encodeURIComponent(location.href);var c=z.surl+"?content=''&imgUrl="+encodeURIComponent(picUrl)+"&widgetSid="+widgetSid+"&pageUrl="+encodeURIComponent(location.href)+"&shareTo="+shareTo+"&time="+time;var d="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=580, height=500";switch(a.className){case"sina-ico":q.open('http://v.t.sina.com.cn/share/share.php?title='+title+'&url='+url+'&pic='+picUrl,"_blank",d);break;case"renren-ico":q.open('http://share.renren.com/share/buttonshare.do?link='+url,"_blank",d);break;case"tx-ico":q.open('http://share.v.t.qq.com/index.php?c=share&a=index&title='+title+'&url='+url+'&pic='+picUrl,"_blank",d);break;case"qzone-ico":q.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?showcount=1&url='+url+'&title='+title+'&pics='+picUrl+'&summary=','_blank',d);break;case"sohu-ico":q.open('http://t.sohu.com/third/post.jsp?url='+url+'&title='+title+'&content=&pic='+picUrl,'_blank',d);break;case"kaixin-ico":q.open('http://www.kaixin001.com/login/open_login.php?flag=1&url='+url+'&pic='+picUrl+'&content='+title,'_blank',d);break;case"wangyi-ico":q.open('http://t.163.com/article/user/checkLogin.do?link='+location.host+'source=&info='+title+url+'&images='+picUrl,'_blank',d);break;case"douban-ico":q.open('http://shuo.douban.com/!service/share?image='+picUrl+'&href='+url+'&name='+title,'_blank',d);break}A.importFile('js',c)},isSlideLeft:function(){var a=this.img,pos=A.getXY(a),w=z.width+42;if(z.position==0){if(z.outPosition==1){this.isLeft=true}else if(z.outPosition==2){this.isLeft=false}else{this.isLeft=pos.x+a.offsetWidth+w>(Math.max(u.body.clientWidth,u.documentElement.clientWidth))?true:false}}else if(z.position==1){if(z.outPosition==1){this.isLeft=false}else if(z.outPosition==2){this.isLeft=true}else{this.isLeft=w<=pos.x?true:false}}return this.isLeft},detect:function(){var a=this,img=a.img,origin=a.originInfo,ad=a.adWrapper,pos=A.getXY(img);if(img.clientWidth<=0||img.clientHeight<=0){var b=u.images;for(var i=b.length;i--;){if(b[i].src==img.src&&b[i].clientWidth>=z.imiw&&b[i].clientHeight>=z.imih){if(img.insId==b[i].getAttribute('instreet_img_id')){b[i].insId=img.insId;a.img=b[i];origin.pos=pos;a.bindImgEvents(a.img);a.locate();break}}}}if(img.src&&img.src!=origin.src){K(img.insId);isFirst=true;origin.src=img.src;typeof z.adsLimit=='number'&&z.adsLimit++;J.onImgLoad(img)}else if(pos.x!==origin.pos.x||pos.y!==origin.pos.y||img.clientWidth!=origin.width||img.clientHeight!=origin.height){origin.pos=pos;origin.width=img.clientWidth;origin.height=img.clientHeight;a.locate()}},recordShow:function(a){var b=this,data=b.data,img=b.img,ul=z.iurl,pd=data.widgetSid,muh=data.imageUrlHash,iu=encodeURIComponent(encodeURIComponent(img.src)),focus=A.$(b.tabs,null,'focus')[0];var c="",adsType="",index=0,mx='',time=new Date().getTime();if(focus){if(focus.lastChild.className=="ad"){var d=data.badsSpot[0];c=d.adsId;adsType=d.adsType;d.adViewMonitorUrl&&A.importFile('js',d.adViewMonitorUrl+'?time='+time)}else if(focus.lastChild.className=="shop"){index=b.getSelectedIndex("shop");c=data.adsSpot[index].adsId;adsType=data.adsSpot[index].adsType;mx=data.adsSpot[index].metrix}}ul+="?pd="+pd+"&mx="+mx+"&muh="+muh+"&iu="+iu+"&ad="+c+"&at="+adsType+"&flag="+a+"&time="+time;A.importFile('js',ul)},recordWatch:function(a){var b=this,data=b.data,img=b.img,iu=encodeURIComponent(encodeURIComponent(img.src)),pd=data.widgetSid,ul=z.murl,mid=data.imageNumId||'',muh=data.imageUrlHash,adData,ad='',at='',tg='',ift=0,tty=1,mx='';var c=a.className,index=b.getSelectedIndex(c);if(c=="shop"){ad=data.adsSpot[index].adsId;at=data.adsSpot[index].adsType;mx=data.adsSpot[index].metrix;tty=0}else if(c=="weibo"){ift=2;mx=data.weiboSpot[index].metrix||''}else if(c=="wiki"){ift=4;mx=data.wikiSpot[index].metrix||''}else if(c=="weather"){ift=7}else if(c=="news"){ift=5}else if(c=="ad"){ad=data.badsSpot[0].adsId;at=data.badsSpot[0].adsType;tty=0}else{return}var d=new Date().getTime();ul+="?iu="+iu+"&mx="+mx+"&pd="+pd+"&muh="+muh+"&ad="+ad+"&at="+at+"&tty="+tty+"&ift="+ift+"&time="+d;A.importFile('js',ul)}};M.createTab=function(a,b,c){var d=u.createElement("li");d.className="clearfix tab";d.className+=c?" "+c:"";d.innerHTML="<a class='"+a+"' href='javascript:;' target='_self'><span></span><em>"+b+"</em></a>";return d};M.chooseItem=function(a,b){if(a.className.match(" focus")){return}var c=a.parentNode,container=c.previousSibling,fi=A.$(container,null,'focus')[0],fs=A.$(c,null,'focus')[0],next=container.children[b];fi.className=fi.className.replace(" focus","");fs.className=fs.className.replace(" focus","");next.className+=" focus";a.className+=" focus"};M.reLocate=function(){var a=J.adsArray;for(i in a){var b=a[i];b.locate&&b.locate()}};M.recordImage=function(a){var b=encodeURIComponent(encodeURIComponent(a.src)),pd=z.widgetSid,pu=encodeURIComponent(encodeURIComponent(q.location.href)),t=encodeURIComponent(encodeURIComponent(u.title)),ul=z.ourl;var c=new Date().getTime();ul+="?iu="+b+"&pd="+pd+"&t="+t+"&time="+c;A.importFile('js',ul)};M.modules={adApp:function(a){if(!z.showFootAd||a.data.badsSpot.length==0)return;var b,cont,data,app,redUrl,w=z.width;if(a.isFirstApp){b=M.createTab('ad','推广','first');a.isFirstApp=false}else{b=M.createTab('ad','推广')}data=a.data;app=data.badsSpot[0];cont=u.createElement("li");cont.className="ad";if(app.adClickMonitorUrl){var c=app.adClickMonitorUrl+encodeURIComponent(encodeURIComponent(app.adsLinkUrl||''));redUrl=z.redurl+"?tty=0&mx=&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift=&at="+(app.adsType||'')+"&ad="+(app.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(c))}else{redUrl=z.redurl+"?tty=0&mx=&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift=&at="+(app.adsType||'')+"&ad="+(app.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(app.adsLinkUrl||''))}str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>品牌推广</h3><div class="main-cont">';if(app.adsType==3){str+="<a class='large-image' target='_blank' href='"+redUrl+"'><img src='"+app.adsPicUrl+"' alt=''/></a>"}else if(app.adsType==9){str+='<object id="afg-adloader" width="'+w+'" height="'+w+'"  align="middle" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">';str+='<param value="always" name="allowScriptAccess"/><param value="'+app.adsPicUrl+'" name="movie"/><param value="high" name="quality"/><param value="opaque" name="wmode"/><param value="high" name="quality"><param value="#F1F1F1" name="bgcolor"/>';str+='<embed width="'+w+'" height="'+w+'" align="middle" pluginspage="http://www.adobe.com/go/getflashplayer"  type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque"  bgcolor="#F1F1F1" quality="high" src="'+app.adsPicUrl+'"></object>';str+='<a class="flash-cover" href="'+redUrl+'" target="_blank"></a>'}else if(!app.adsLinkUrl&&app.description){str+='<iframe src="'+app.description+'" scrolling="no" height="'+z.height+'" width="'+z.width+'" frameborder="0" border="0" marginwidth="0" marginheight="0"></iframe>'}str+='</div>';cont.innerHTML=str;return{tab:b,cont:cont}},shopApp:function(a){if(!z.showAd||a.data.adsSpot.length==0)return;var b,cont,str,data,app,redUrl,imgUrl,title,price,focus,selectStr='<div class="in-shop-selector">';if(a.isFirstApp){b=M.createTab('shop','折扣','first');a.isFirstApp=false}else{b=M.createTab('shop','折扣')}data=a.data;cont=u.createElement("li");cont.className="shop";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>品牌折扣</h3><div class="main-cont">';str+='<div class="in-slider-container">';for(var i=0,len=data.adsSpot.length;i<len;i++){focus=i==0?" focus":"";app=data.adsSpot[i];a.createSpot(app,i);redUrl=z.redurl+"?tty=0&mx="+app.metrix+"&muh="+data.imageUrlHash+"&pd="+app.widgetSid+"&ift=&at="+app.adsType+"&ad="+app.adsId+"&rurl="+encodeURIComponent(encodeURIComponent(app.adsLinkUrl));title=app.adsTitle;price=app.adsDiscount||app.adsPrice;imgUrl=app.adsPicUrl.replace("160x160",z.width+"x"+z.width);str+='<a target="_blank" class="pro-box'+focus+'" href="'+redUrl+'"><img class="ins-shop-image" src="'+imgUrl+'"/><span class="pro-info"><span class="pro-name">'+title+'</span><span class="pro-tobuy"><em>进入商店</em></span><span class="pro-price">¥'+price+'</span></span></a>';if(len>1)selectStr+='<a href="javascript:;" target="_self" class="select-item'+focus+'"></a>'}str+='</div>'+selectStr+'</div></div>';cont.innerHTML=str;return{tab:b,cont:cont}},weiboApp:function(a){if(!z.showWeibo)return;var b,cont,data,app,title,redUrl,article,avatar,str="",focus="",selectStr='<div class="in-weibo-selector">',w=z.width,weiboUrl='http://widget.weibo.com/list/list.php?language=zh_cn&width='+w+'&height=300&listid=3567706361920211&appkey=2223861179&uname=%E7%88%B1%E6%AF%8F%E5%8F%AE&uid=2546960673&listname=CNTV&color=&showcreate=0&isborder=1&info=0&sidebar=1&footbar=1&dpc=1%3E%3C/iframe#0';if(a.isFirstApp){b=M.createTab('weibo','微博','first');a.isFirstApp=false}else{b=M.createTab('weibo','微博')}data=a.data;cont=u.createElement("li");cont.className="weibo";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>精彩微博</h3><div class="main-cont">';str+='<div class="in-slider-container">';str+='<div style="max-height:none;" class="weibo-item focus"><iframe name="ins-weibo-frame" src="'+weiboUrl+'" width="'+w+'" height="300" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div>';str+='</div>'+selectStr+'</div></div>';cont.innerHTML=str;return{tab:b,cont:cont}},wikiApp:function(a){if(!z.showWiki||a.data.wikiSpot.length==0)return;var b,cont,data,app,title,redUrl,article,avatar,str="",focus="",selectStr='<div class="in-wiki-selector">';if(a.isFirstApp){b=M.createTab('wiki','百科','first');a.isFirstApp=false}else{b=M.createTab('wiki','百科')}data=a.data;cont=u.createElement("li");cont.className="wiki";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>相关百科</h3><div class="main-cont">';str+='<div class="in-slider-container">';for(var i=0,len=data.wikiSpot.length;i<len;i++){focus=i==0?" focus":"";app=data.wikiSpot[i];a.createSpot(app,i);avatar=app.firstimg;title=app.title;article=app.summary;redUrl=z.redurl+"?tty=1&mx="+app.metrix+"&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift="+app.type+"&at=&tg="+encodeURIComponent(encodeURIComponent(title))+"&rurl="+encodeURIComponent(encodeURIComponent(app.url));str+='<div class="wiki-item'+focus+'"><div class="left"><a class="thumb" href="'+redUrl+'" target="_blank" title="'+title+'"><img src="'+avatar+'"/></a><h3><a class="tagName" href="'+redUrl+'" target="_blank">'+title+'</a></h3></div><div class="right"><p><em class="arrow-one"></em><em class="arrow-two"></em>'+article+'</p><div class="icon-section"><a href="'+redUrl+'" target="_blank"><img src="http://static.instreet.cn/widgets/push/images/icon_baike.png"/></a></div></div></div>';if(len>1)selectStr+='<a href="javascript:;" target="_self" class="select-item'+focus+'"></a>'}str+='</div>'+selectStr+'</div></div>';cont.innerHTML=str;return{tab:b,cont:cont}},newsApp:function(a){if(!z.showNews)return;var b,c,data=a.data,w=z.width,h=z.height,newsUrl=v+"news?size="+w+"&pd="+data.widgetSid+"&muh="+data.imageUrlHash;if(a.isFirstApp){b=M.createTab('news','新闻','first');a.isFirstApp=false}else{b=M.createTab('news','新闻')}var c=u.createElement("li");c.className="news";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>热点新闻</h3><div class="main-cont">';str+='<iframe name="weather_inc" src="'+newsUrl+'" width="'+w+'" height="'+h+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>';str+='</div>';c.innerHTML=str;return{tab:b,cont:c}},weatherApp:function(a){if(!z.showWeather)return;var b,c,w=z.width,weatherUrl="http://www.thinkpage.cn/weather/weather.aspx?uid=&cid=101010100&l=zh-CHS&p=TWC&a=1&u=C&s=1&m=0&x=1&d=3&fc=&bgc=&bc=&ti=1&in=1&li=2&ct=iframe";if(a.isFirstApp){b=M.createTab('weather','天气','first');a.isFirstApp=false}else{b=M.createTab('weather','天气')}var c=u.createElement("li");c.className="weather";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>天气预报</h3><div class="main-cont">';str+='<iframe name="weather_inc" src="'+weatherUrl+'" width="'+w+'" height="110" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="true" ></iframe>';str+='</div>';c.innerHTML=str;return{tab:b,cont:c}},shareApp:function(a){if(!z.showShareButton)return;var b,c;if(a.isFirstApp){b=M.createTab('share','分享','first');a.isFirstApp=false}else{b=M.createTab('share','分享')}var c=u.createElement("li");c.className="share";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>图片分享</h3><div class="main-cont">';str+='<div class="in-share-icons"><a title="新浪微博" class="sina-ico" href="javascript:;" target="_self"></a><a title="腾讯微博" class="tx-ico" href="javascript:;" target="_self"></a><a title="QQ空间" class="qzone-ico" href="javascript:;" target="_self"></a><a title="人人网" class="renren-ico" href="javascript:;" target="_self"></a><a title="搜狐微博" class="sohu-ico" href="javascript:;" target="_self"></a><a title="网易微博" class="wangyi-ico" href="javascript:;" target="_self"></a><a title="豆瓣" class="douban-ico" href="javascript:;" target="_self"></a><a title="开心网" class="kaixin-ico" href="javascript:;" target="_self"></a>';str+='</div></div>';c.innerHTML=str;return{tab:b,cont:c}}};var N=function(a){a=a||0;var b=u.getElementsByTagName('img');for(var i=0,len=b.length;i<len;i++){var c=b[i];if(c.className.indexOf('ins-shop-image')!=-1||c.insDataLoading==true||c.getAttribute('instreet_data_loading')||c.insDataLoaded==true||c.getAttribute('instreet_data_loaded')){continue}if(typeof c.insId=='undefined'){c.insId=imgs.length}c.setAttribute('instreet_img_id',c.insId);imgs[c.insId]=c;J.onImgLoad(c)}if(a<5){setTimeout(function(){N(++a)},1000)}};var O=function(c){if(c&&typeof c=="object"){for(var i in c){z[i]=c[i]}}else{return}z.color=z.color&&z.color.toLowerCase()};function init(){if(typeof instreet_config!="undefined"){O(instreet_config)}L.init();J.initData();A.bind(q,'load',function(){M.reLocate();N()});A.bind(q,'resize',function(){M.reLocate()});I(J.adsArray)};F(function(){init()})})(window);