(function(q,u){if(typeof q.InstreetWidget!="undefined"||q.InstreetWidget!=null){return null}else{q.InstreetWidget={version:"@REVISION@",name:"InstreetImageWidget"}}var v=q.document,navigator=q.navigator,location=q.location,host=location.hostname,isIE=!!q.ActiveXObject,imgs=[],E=[],isFirst=true;var z=[{host:'*.msn.com.cn',containerId:'picbox',leftClass:'p_left',leftTitle:'上一张',rightClass:'p_right',rightTitle:'下一张'}];var A="http://push.instreet.cn/";var B={redurl:A+"click.action",callbackurl:A+"push.action",murl:A+"tracker.action",iurl:A+"tracker90.action",ourl:A+"loadImage.action",surl:A+"share/weiboshare",cssurl:'http://static.instreet.cn/widgets/push/css/instreet.sprint.min.css',imih:300,imiw:300,timer:1000,width:250,height:250};var C={bind:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}else{a["on"+b]=c}},remove:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else if(a.datachEvent){a.datachEvent("on"+b,c)}else{a["on"+b]=null}},getEvent:function(a){return a?a:q.event},getTarget:function(a){return a.target||a.srcElement},stopPropagation:function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},getRelatedTarget:function(a){if(a.relatedTarget){return a.relatedTarget}else if(a.type=="mouseover"){return a.fromElement}else if(a.type=="mouseout"){return a.toElement}else{return null}},getXY:function(a){var x=0,y=0;if(a.getBoundingClientRect){var b=a.getBoundingClientRect();var D=v.documentElement;x=b.left+Math.max(D.scrollLeft,v.body.scrollLeft)-D.clientLeft;y=b.top+Math.max(D.scrollTop,v.body.scrollTop)-D.clientTop}else{for(;a!=v.body;x+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent){}};return{x:x,y:y}},aTrim:function(c){var d=new Array();c.sort(sortNum);var e=c.length,flag=0;for(var i=0;i<e;i++){if(c[i]!=c[i+1]){d[flag]=c[i];flag++}}return d;function sortNum(a,b){return a-b}},$:function(a,b,c){var d=a||v,e;if(arguments.length==2){c=b;e="*"}else{var e=b||'*'}if(v.getElementsByClassName)return d.getElementsByClassName(c);var f=[];var g=d.getElementsByTagName(e);for(var l=g.length,i=l;i--;){var h=g[i];if(h.className){var k=h.className.replace(/\s/g,'|').split('|');for(var m=k.length,j=m;j--;){if(k[j]==c){f.push(h);break}}}}return f},importFile:function(a,b){var c;switch(a){case"js":c=v.createElement('script');c.src=b;c.charset="utf-8";c.type="text/javascript";break;case"css":c=v.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=b;break}var d=v.getElementsByTagName('head')[0];d.appendChild(c)},isVisible:function(a){if(a==v)return true;if(!a)return false;if(!a.parentNode)return false;if(a.style){if(a.style.display=='none')return false;if(a.style.visibility=='hidden')return false}if(q.getComputedStyle){var b=q.getComputedStyle(a,"");if(b.display=='none')return false;if(b.visibility=='hidden')return false}var b=a.currentStyle;if(b){if(b['display']=='none')return false;if(b['visibility']=='hidden')return false}return C.isVisible(a.parentNode)}};var $=function(a){return v.getElementById(a)},each=function(a,b){if(a.length){for(var i=0,len=a.length;i<len;i++){b.call(a[i],i)}}else{b.call(a,0)}},hide=function(a){each(a,function(){this.style.display="none"})},show=function(a){each(a,function(){this.style.display="block"})};var E=[];var F=function(){for(var i=0;i<E.length;i++)E[i]&&E[i]()};var G=function(){try{v.documentElement.doScroll('left')}catch(err){setTimeout(G,1);return}F()};var H=function(a){var b=!!q.ActiveXObject;if(v.readyState==="complete"){E.push(a);F();return}if(E.push(a)>1)return;if(v.addEventListener)return v.addEventListener('DOMContentLoaded',F,false);if(b){G()}};var I={get:function(a,b){var c;if(b=="float"){v.defaultView?b='cssFloat':b='styleFloat'}if(b=="opacity"){v.defaultView?b='opacity':b='filter'}if(v.defaultView&&v.defaultView.getComputedStyle){var c=v.defaultView.getComputedStyle(a,null)[b]}else if(a.currentStyle){c=a.currentStyle[b];if(b=="filter"){if(c.match("alpha")){c=parseFloat(c.match(/\d+/)[0])/100}else if(!c){c=1}}}typeof c=="string"&&c.match("px")?c=parseInt(c.replace("px","")):c;b=="opacity"?c=parseInt(c):c;return c},set:function(a,b,c){if(b=="float"){v.defaultView?b='cssFloat':b='styleFloat'}if(b=="opacity"){a.style.filter="alpha(opacity="+c*100+")";a.style.zoom=1}a.style[b]=c}};var J=(function(){var j=[],timerId;var k=function(a){for(var b in a){return false}return true};var l=function(a,b,c,d,e){var f=l.getOpt(c,d,e);if(a&&a.nodeType==1){var g,to;if(b&&typeof b=="object"){if(k(b)){e.call(a)}else{for(var h in b){var i=new m(a,f,h);g=I.get(a,h);end=parseFloat(b[h]);i.custom(g,end)}}}}};l.getOpt=function(a,b,c){var d={duration:a||200,easing:b||"linear"};d.callback=function(){c&&c()};return d};l.stop=function(a,b){b=b||false;for(var i=j.length;i--;){var c=j[i];if(c.elem===a){if(b){c.update(c.name,c.end)}j.splice(i,1)}}};var m=function(a,b,c){this.elem=a;this.options=b;this.name=c};m.prototype.custom=function(a,b){this.startTime=new Date().getTime();this.start=a;this.end=b;j.push(this);m.tick()};m.prototype.step=function(){var a=new Date().getTime(),nowPos;if(a>this.options.duration+this.startTime){nowPos=this.end;this.options.callback.call(this.elem);this.stop()}else{var n=a-this.startTime;var b=n/this.options.duration;var c=o[this.options.easing](b,0,1,this.options.duration);nowPos=this.start+((this.end-this.start)*c)}this.update(this.name,nowPos)};m.prototype.stop=function(){for(var i=j.length;i--;){if(j[i]===this){j.splice(i,1)}}};m.prototype.update=function(a,b){if(a!="opacity"){b+="px"}I.set(this.elem,a,b)};m.tick=function(){if(timerId)return;timerId=setInterval(function(){for(var i=0,len=j.length;i<len;i++){j[i]&&j[i].step()}if(!j.length){m.stop()}},13)};m.stop=function(){clearInterval(timerId);timerId=null};var o={linear:function(p){return p},swing:function(p){return(-Math.cos(p*Math.PI)/2)+0.5}};return l})();var K=(function(){var b=null;return function(a){b=setInterval(function(){for(var i=0;i<a.length;i++){a[i]&&a[i].detect()}},500)}})();var L={adsArray:[],initData:function(){var a=v.getElementsByTagName('img');for(var i=0,len=a.length;i<len;i++){var b=a[i];imgs[i]=b;b.insId=i;b.setAttribute("instreet_img_id",i);L.onImgLoad(b)}},onImgLoad:function(b){var c=new Image();c.src=b.src,c.insId=b.insId;if(c.complete){L.loadData(c)}else{c.onload=function(){var a=this;a.onload=null;L.loadData(c)}}},loadData:function(a){var b=a.insId,clientImg=imgs[b];if(a.width>=B.imiw&&a.height>=B.imih){if(clientImg.clientWidth>=B.imiw&&clientImg.clientHeight>=B.imih||(clientImg.clientWidth==0&&clientImg.clientHeight==0)){if(typeof B.adsLimit=="number"&&B.adsLimit<=0){return}clientImg.setAttribute('instreet_data_loading',true);clientImg.insDataLoading=true;O.recordImage(clientImg);L.createJsonp(clientImg);B.adsLimit&&B.adsLimit--}}},createJsonp:function(a){var w=B.width||250,h=B.height||250;var b=encodeURIComponent(encodeURIComponent(a.src)),url=B.callbackurl+"?index="+a.insId+"&pd="+B.widgetSid+"&iu="+b+"&callback=insjsonp"+"&w="+w+"&h="+h;C.importFile('js',url)}};q['insjsonp']=function(a){if(a){var b=a.index,img=imgs[b];img.insDataLoaded=true;img.setAttribute('instreet_data_loaded',true);var c=new O(a,N.container);M(b);L.adsArray[b]=c}};var M=function(a){var b=L.adsArray[a];if(b&&b.adWrapper){var c=b.adWrapper,parent=c.parentNode;parent&&parent.removeChild(c);for(var i=0,len=b.spotsArray.length;i<len;i++){var p=b.spotsArray[i].parentNode;p&&p.removeChild(b.spotsArray[i])}}};var N={init:function(){var a=B.cssurl;C.importFile('css',a);N.createContainer()},createContainer:function(){var a=v.createElement('div'),spotBox=v.createElement('div');a.id="instreet-plugin-container";spotBox.id="instreet-plugin-spotbox";N.container=a;N.spotBox=spotBox;a.appendChild(spotBox);v.body.children&&v.body.insertBefore(a,v.body.firstChild)}};var O=function(a,b){var c=imgs[a.index];this.data=a;this.container=b;this.img=c;this.originInfo={width:c.clientWidth,height:c.clientHeight,src:c.src,pos:C.getXY(c)};this.spotsArray=[];this.timerId=null;this.init()};O.prototype={constructor:O,isFirstApp:true,init:function(){var a=this;a.createApps();a.locate();a.bindEvents()},createApps:function(){var a=this;var b=v.createElement("div"),tabWrapper=v.createElement("ul"),contentWrapper=v.createElement("ul");if(B.position==0){b.className="in-ad-wrapper in-position-right"}else if(B.position==1){b.className="in-ad-wrapper in-position-left"}if(B.color){b.className+=" in-"+B.color+"style"}if(B.width){b.className+=" in-size"+B.width}tabWrapper.className="in-tabs-wrapper";contentWrapper.className="in-contents-wrapper";contentWrapper.style.width="0";var c=v.createDocumentFragment(),contFrag=v.createDocumentFragment();for(i in O.modules){if(typeof O.modules[i]=='function'){var d=O.modules[i](a);if(d){d.tab&&c.appendChild(d.tab);d.cont&&contFrag.appendChild(d.cont)}}}tabWrapper.appendChild(c);contentWrapper.appendChild(contFrag);b.appendChild(tabWrapper);b.appendChild(contentWrapper);a.container.appendChild(b);a.adWrapper=b;a.tabs=tabWrapper;a.contents=contentWrapper},createSpot:function(a,b){var c=a.width,metrix=a.metrix,spot=v.createElement("a"),spotContainer=$("instreet-plugin-spotbox");spot.href="javascript:;";spot.index=b;spot.target="_self";spot.metrix=metrix;spot.imgWidth=c;if(a.adsType)spot.className="instreet-shopSpot";else if(a.type.toString()=="1"||a.type.toString()=="2")spot.className="instreet-weiboSpot";else if(a.type.toString()=="4")spot.className="instreet-wikiSpot";this.spotsArray.push(spot);spotContainer.appendChild(spot)},locate:function(){var b=this,img=b.img,pos=C.getXY(img),w=img.offsetWidth,left=(pos.x+w)+"px",right=(Math.max(v.body.clientWidth,v.documentElement.clientWidth)-pos.x)+'px',top=pos.y+"px",spotsArray=b.spotsArray;var c=b.isSlideLeft();var d=C.isVisible(img)&&img.clientWidth>=B.imiw&&img.clientHeight>=B.imih?"block":"none";function setFloat(a){if(isIE){b.tabs.style.styleFloat=a;b.contents.style.styleFloat=a}else{b.tabs.style.cssFloat=a;b.contents.style.cssFloat=a}};if(B.position==0){if(c){setFloat("right");b.contents.className="in-contents-wrapper in-contents-slideleft";b.adWrapper.style.left="auto";b.adWrapper.style.right=(Math.max(v.body.clientWidth,v.documentElement.clientWidth)-pos.x-w-26)+"px"}else{setFloat("left");b.contents.className="in-contents-wrapper";b.adWrapper.style.right="auto";b.adWrapper.style.left=left}}else if(B.position==1){if(c){setFloat("right");b.contents.className="in-contents-wrapper";b.adWrapper.style.right=right;b.adWrapper.style.left="auto"}else{setFloat("left");b.contents.className="in-contents-wrapper in-contents-slideright";b.adWrapper.style.left=(pos.x-26)+"px";b.adWrapper.style.right="auto"}}b.adWrapper.style.top=top;b.adWrapper.style.display=d;if(d=='block'&&B.footAuto&&b.isFirst!=false){b.isFirst=false;b.showApp();b.recordShow(9)}if(spotsArray.length>0){var e=spotsArray[0].imgWidth,zoomNum=img.width/e,r=15;for(var j=spotsArray.length;j--;){var f=spotsArray[j];metrix=f.metrix,ox=metrix%3000,oy=Math.round(metrix/3000),x=ox*zoomNum,y=oy*zoomNum;f.style.cssText="top:"+(y+pos.y-r)+"px;left:"+(x+pos.x-r)+"px;display:"+d}}},bindEvents:function(){var c=this,list=c.tabs.children,contents=c.contents.children;c.bindImgEvents(c.img);c.tabs.onmouseover=function(){clearTimeout(c.timerId)};c.tabs.onmouseout=function(){c.timerId=setTimeout(function(){c.closeApp()},B.timer)};c.contents.onmouseover=function(){clearTimeout(c.timerId)};c.contents.onmouseout=function(){c.timerId=setTimeout(function(){c.closeApp()},B.timer)};c.contents.onclick=function(e){var a=C.getEvent(e),tar=C.getTarget(a);if(tar.className=='in-close'){c.closeApp();if(B.position==0&&c.isLeft||B.position==1&&!c.isLeft){c.notopen=true}}else if(tar.parentNode.className=="in-share-icons"){c.shareImg(tar)}C.stopPropagation(a)};var d=C.$(c.contents,null,'in-shop-selector')[0];d&&each(d.children,function(a){var b=this;b.onclick=function(){O.chooseItem(this,a)}});var f=C.$(c.contents,null,'in-weibo-selector')[0];f&&each(f.children,function(a){var b=this;b.onclick=function(){O.chooseItem(this,a)}});var g=C.$(c.contents,null,'in-wiki-selector')[0];g&&each(g.children,function(a){var b=this;b.onclick=function(){O.chooseItem(this,a)}});for(var i=0,len=list.length;i<len;i++){var h=list[i],content=contents[i];h.onmouseover=function(){if(this.className.match(" focus")){return}var a=this.lastChild.className;c.showApp(this);if(a=="ad"||a=="shop"){c.recordShow(9)}};content.onmouseover=function(e){var a=C.getEvent(e),tar=C.getRelatedTarget(a);show(this);if(!this.contains(tar)){c.recordWatch(this)}}}for(var j=0,l=c.spotsArray.length;j<l;j++){var k=c.spotsArray[j];k.onmouseover=function(){clearTimeout(c.timerId);switch(this.className){case"instreet-shopSpot":var a=C.$(c.tabs,null,'shop')[0].parentNode,sel=C.$(c.contents,null,'in-shop-selector')[0].children[this.index];var b;if(sel){b=sel.className.match(" focus")}else{b=a.className.match(" focus")}sel&&O.chooseItem(sel,this.index);c.showApp(a);if(!b){c.recordShow(9)}break;case"instreet-weiboSpot":var a=C.$(c.tabs,null,'weibo')[0].parentNode,sel=C.$(c.contents,null,'in-weibo-selector')[0].children[this.index];sel&&O.chooseItem(sel,this.index);c.showApp(a);break;case"instreet-wikiSpot":var a=C.$(c.tabs,null,'wiki')[0].parentNode;sel=C.$(c.contents,null,'in-wiki-selector')[0].children[this.index];sel&&O.chooseItem(sel,this.index);c.showApp(a);break}}}},bindImgEvents:function(e){var _=this,left,right,i=0;var f=function(c){var d=v.getElementById(c.containerId)||v;var a=C.$(d,c.leftClass)[0],b=C.$(d,c.rightClass)[0];if(!a||!b){return}if(c.leftTitle&&c.leftTitle!=a.title||c.rightTitle&&c.rightTitle!=b.title){return}left=a;right=b};for(;i<z.length;i++){var s=z[i],reg=new RegExp(s.host.replace('*','[a-z]+')+'$','i');if(reg.test(host)){f(s);continue}}var g=function(){clearTimeout(_.timerId);if(_.notopen){return}if(_.contents.offsetWidth==0){_.showApp();_.recordShow(10)}},out=function(){clearTimeout(_.timerId);_.timerId=setTimeout(function(){_.closeApp()},B.timer);_.notopen=false};C.bind(e,'mouseover',g);left&&C.bind(left,'mouseover',g);left&&C.bind(left,'mouseout',out);C.bind(e,'mouseout',out);right&&C.bind(right,'mouseover',g);right&&C.bind(right,'mouseout',out)},hideApps:function(){var a=this,list=a.tabs.children;for(var j=list.length;j--;){if(list[j].className.match("focus")){list[j].className=list[j].className.replace(" focus","")}}if(isIE){hide(a.contents.children)}else{each(a.contents.children,function(){this.style.cssText="display:block;visibility:hidden;height:0;overflow:hidden;"})}if(a.adWrapper.style.width!="auto"){a.adWrapper.style.width="auto"}},closeApp:function(){this.hideApps();this.contents.style.width=0},showApp:function(a){var b=this,list=b.tabs.children,type,app,width;if(list.length==0){return}if(!a){a=list[0]}type=a.lastChild.className;b.hideApps();if(b.adWrapper.style.width=="auto"){b.adWrapper.style.width=(B.width+42)+'px'}a.className+=" focus";if(isIE){show(C.$(b.contents,'li',type))}else{each(C.$(b.contents,'li',type),function(){this.style.cssText="display:block;visibility:visible;height:auto;"})}width=(B.width+16)+"px";if(I.get(b.contents,'width')==0){J(b.contents,{width:width},200,'linear')}},getSelectedIndex:function(a){var b='in-'+a+'-selector',sels=C.$(this.contents,null,b)[0]?C.$(this.contents,null,b)[0].children:[];for(var j=0,len=sels.length;j<len;j++){if(sels[j].className.match(" focus")){return j}}return 0},shareImg:function(a){var b=this,picUrl=encodeURIComponent(b.img.src),shareTo=a.className.replace("-ico",""),widgetSid=b.data.widgetSid,time=new Date().getTime(),title=encodeURIComponent(v.title),url=encodeURIComponent(location.href);var c=B.surl+"?content=''&imgUrl="+encodeURIComponent(picUrl)+"&widgetSid="+widgetSid+"&pageUrl="+encodeURIComponent(location.href)+"&shareTo="+shareTo+"&time="+time;var d="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=580, height=500";switch(a.className){case"sina-ico":q.open('http://v.t.sina.com.cn/share/share.php?title='+title+'&url='+url+'&pic='+picUrl,"_blank",d);break;case"renren-ico":q.open('http://share.renren.com/share/buttonshare.do?link='+url,"_blank",d);break;case"tx-ico":q.open('http://share.v.t.qq.com/index.php?c=share&a=index&title='+title+'&url='+url+'&pic='+picUrl,"_blank",d);break;case"qzone-ico":q.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?showcount=1&url='+url+'&title='+title+'&pics='+picUrl+'&summary=','_blank',d);break;case"sohu-ico":q.open('http://t.sohu.com/third/post.jsp?url='+url+'&title='+title+'&content=&pic='+picUrl,'_blank',d);break;case"kaixin-ico":q.open('http://www.kaixin001.com/login/open_login.php?flag=1&url='+url+'&pic='+picUrl+'&content='+title,'_blank',d);break;case"wangyi-ico":q.open('http://t.163.com/article/user/checkLogin.do?link='+location.host+'source=&info='+title+url+'&images='+picUrl,'_blank',d);break;case"douban-ico":q.open('http://shuo.douban.com/!service/share?image='+picUrl+'&href='+url+'&name='+title,'_blank',d);break}C.importFile('js',c)},isSlideLeft:function(){var a=this.img,pos=C.getXY(a),w=B.width+42;if(B.position==0){if(B.outPosition==1){this.isLeft=true}else if(B.outPosition==2){this.isLeft=false}else{this.isLeft=pos.x+a.offsetWidth+w>(Math.max(v.body.clientWidth,v.documentElement.clientWidth))?true:false}}else if(B.position==1){if(B.outPosition==1){this.isLeft=false}else if(B.outPosition==2){this.isLeft=true}else{this.isLeft=w<=pos.x?true:false}}return this.isLeft},detect:function(){var a=this,img=a.img,origin=a.originInfo,ad=a.adWrapper,pos=C.getXY(img);if(img.clientWidth<=0||img.clientHeight<=0){var b=v.images;for(var i=b.length;i--;){if(b[i].src==img.src&&b[i].clientWidth>=B.imiw&&b[i].clientHeight>=B.imih){if(img.insId==b[i].getAttribute('instreet_img_id')){b[i].insId=img.insId;a.img=b[i];origin.pos=pos;a.bindImgEvents(a.img);a.locate();break}}}}if(img.src&&img.src!=origin.src){M(img.insId);isFirst=true;origin.src=img.src;typeof B.adsLimit=='number'&&B.adsLimit++;L.onImgLoad(img)}else if(pos.x!==origin.pos.x||pos.y!==origin.pos.y||img.clientWidth!=origin.width||img.clientHeight!=origin.height){origin.pos=pos;origin.width=img.clientWidth;origin.height=img.clientHeight;a.locate()}},recordShow:function(a){var b=this,data=b.data,img=b.img,ul=B.iurl,pd=data.widgetSid,muh=data.imageUrlHash,iu=encodeURIComponent(encodeURIComponent(img.src)),focus=C.$(b.tabs,null,'focus')[0];var c="",adsType="",index=0,mx='',time=new Date().getTime();if(focus){if(focus.lastChild.className=="ad"){var d=data.badsSpot[0];c=d.adsId;adsType=d.adsType;d.adViewMonitorUrl&&C.importFile('js',d.adViewMonitorUrl+'?time='+time)}else if(focus.lastChild.className=="shop"){index=b.getSelectedIndex("shop");c=data.adsSpot[index].adsId;adsType=data.adsSpot[index].adsType;mx=data.adsSpot[index].metrix}}ul+="?pd="+pd+"&mx="+mx+"&muh="+muh+"&iu="+iu+"&ad="+c+"&at="+adsType+"&flag="+a+"&time="+time;C.importFile('js',ul)},recordWatch:function(a){var b=this,data=b.data,img=b.img,iu=encodeURIComponent(encodeURIComponent(img.src)),pd=data.widgetSid,ul=B.murl,mid=data.imageNumId||'',muh=data.imageUrlHash,adData,ad='',at='',tg='',ift=0,tty=1,mx='';var c=a.className,index=b.getSelectedIndex(c);if(c=="shop"){ad=data.adsSpot[index].adsId;at=data.adsSpot[index].adsType;mx=data.adsSpot[index].metrix;tty=0}else if(c=="weibo"){ift=2;mx=data.weiboSpot[index].metrix||''}else if(c=="wiki"){ift=4;mx=data.wikiSpot[index].metrix||''}else if(c=="weather"){ift=7}else if(c=="news"){ift=5}else if(c=="ad"){ad=data.badsSpot[0].adsId;at=data.badsSpot[0].adsType;tty=0}else{return}var d=new Date().getTime();ul+="?iu="+iu+"&mx="+mx+"&pd="+pd+"&muh="+muh+"&ad="+ad+"&at="+at+"&tty="+tty+"&ift="+ift+"&time="+d;C.importFile('js',ul)}};O.createTab=function(a,b,c){var d=v.createElement("li");d.className="clearfix tab";d.className+=c?" "+c:"";d.innerHTML="<a class='"+a+"' href='javascript:;' target='_self'><span></span><em>"+b+"</em></a>";return d};O.chooseItem=function(a,b){if(a.className.match(" focus")){return}var c=a.parentNode,container=c.previousSibling,fi=C.$(container,null,'focus')[0],fs=C.$(c,null,'focus')[0],next=container.children[b];fi.className=fi.className.replace(" focus","");fs.className=fs.className.replace(" focus","");next.className+=" focus";a.className+=" focus"};O.reLocate=function(){var a=L.adsArray;for(i in a){var b=a[i];b.locate&&b.locate()}};O.recordImage=function(a){var b=encodeURIComponent(encodeURIComponent(a.src)),pd=B.widgetSid,pu=encodeURIComponent(encodeURIComponent(q.location.href)),t=encodeURIComponent(encodeURIComponent(v.title)),ul=B.ourl;var c=new Date().getTime();ul+="?iu="+b+"&pd="+pd+"&t="+t+"&time="+c;C.importFile('js',ul)};O.modules={adApp:function(a){if(!B.showFootAd||a.data.badsSpot.length==0)return;var b,cont,data,app,redUrl,w=B.width;if(a.isFirstApp){b=O.createTab('ad','推广','first');a.isFirstApp=false}else{b=O.createTab('ad','推广')}data=a.data;app=data.badsSpot[0];cont=v.createElement("li");cont.className="ad";if(app.adClickMonitorUrl){var c=app.adClickMonitorUrl+encodeURIComponent(app.adsLinkUrl||'');redUrl=B.redurl+"?tty=0&mx=&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift=&at="+(app.adsType||'')+"&ad="+(app.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(c))}else{redUrl=B.redurl+"?tty=0&mx=&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift=&at="+(app.adsType||'')+"&ad="+(app.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(app.adsLinkUrl||''))}str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>产品推广</h3><div class="main-cont">';if(app.adsType==3){str+="<a class='large-image' target='_blank' href='"+redUrl+"'><img src='"+app.adsPicUrl+"' alt=''/></a>"}else if(app.adsType==9){str+='<object id="afg-adloader" width="'+w+'" height="'+w+'"  align="middle" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">';str+='<param value="always" name="allowScriptAccess"/><param value="'+app.adsPicUrl+'" name="movie"/><param value="high" name="quality"/><param value="opaque" name="wmode"/><param value="high" name="quality"><param value="#F1F1F1" name="bgcolor"/>';str+='<embed width="'+w+'" height="'+w+'" align="middle" pluginspage="http://www.adobe.com/go/getflashplayer"  type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque"  bgcolor="#F1F1F1" quality="high" src="'+app.adsPicUrl+'"></object>';str+='<a class="flash-cover" href="'+redUrl+'" target="_blank"></a>'}else if(!app.adsLinkUrl&&app.description){str+='<iframe src="'+app.description+'" scrolling="no" height="'+B.height+'" width="'+B.width+'" frameborder="0" border="0" marginwidth="0" marginheight="0"></iframe>'}str+='</div>';cont.innerHTML=str;return{tab:b,cont:cont}},shopApp:function(a){if(!B.showAd||a.data.adsSpot.length==0)return;var b,cont,str,data,app,redUrl,imgUrl,title,price,focus,selectStr='<div class="in-shop-selector">';if(a.isFirstApp){b=O.createTab('shop','折扣','first');a.isFirstApp=false}else{b=O.createTab('shop','折扣')}data=a.data;cont=v.createElement("li");cont.className="shop";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>品牌折扣</h3><div class="main-cont">';str+='<div class="in-slider-container">';for(var i=0,len=data.adsSpot.length;i<len;i++){focus=i==0?" focus":"";app=data.adsSpot[i];a.createSpot(app,i);redUrl=B.redurl+"?tty=0&mx="+app.metrix+"&muh="+data.imageUrlHash+"&pd="+app.widgetSid+"&ift=&at="+app.adsType+"&ad="+app.adsId+"&rurl="+encodeURIComponent(encodeURIComponent(app.adsLinkUrl));title=app.adsTitle;price=app.adsDiscount||app.adsPrice;imgUrl=app.adsPicUrl.replace("160x160",B.width+"x"+B.width);str+='<a target="_blank" class="pro-box'+focus+'" href="'+redUrl+'"><img class="ins-shop-image" src="'+imgUrl+'"/><span class="pro-info"><span class="pro-name">'+title+'</span><span class="pro-tobuy"><em>进入商店</em></span><span class="pro-price">¥'+price+'</span></span></a>';if(len>1)selectStr+='<a href="javascript:;" target="_self" class="select-item'+focus+'"></a>'}str+='</div>'+selectStr+'</div></div>';cont.innerHTML=str;return{tab:b,cont:cont}},weiboApp:function(a){if(!B.showWeibo||a.data.weiboSpot.length==0)return;var b,cont,data,app,title,redUrl,article,avatar,str="",focus="",selectStr='<div class="in-weibo-selector">';if(a.isFirstApp){b=O.createTab('weibo','微博','first');a.isFirstApp=false}else{b=O.createTab('weibo','微博')}data=a.data;cont=v.createElement("li");cont.className="weibo";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" class="in-close">×</a>相关微博</h3><div class="main-cont">';str+='<div class="in-slider-container">';for(var i=0,len=data.weiboSpot.length;i<len;i++){focus=i==0?" focus":"";app=data.weiboSpot[i];a.createSpot(app,i);avatar=app.avatar;icon=app.icon;title=app.title;article=app.latestStatus;redUrl=B.redurl+"?tty=1&mx="+app.metrix+"&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift="+app.type+"&at=&ad=&rurl="+encodeURIComponent(encodeURIComponent(app.userUrl));str+='<div class="weibo-item'+focus+'"><div class="left"><a href="'+redUrl+'" target="_blank" title="'+title+'"><img src="'+avatar+'"/></a></div><div class="right"><h3><a href="'+redUrl+'" target="_blank">'+title+'</a></h3><p><em class="arrow-one"></em><em class="arrow-two"></em>'+article+'</p><div class="icon-section"><a href="'+redUrl+'" target="_blank"><img src="'+icon+'"/></a></div></div></div>';if(len>1)selectStr+='<a href="javascript:;" class="select-item'+focus+'"></a>'}str+='</div>'+selectStr+'</div></div>';cont.innerHTML=str;return{tab:b,cont:cont}},wikiApp:function(a){if(!B.showWiki||a.data.wikiSpot.length==0)return;var b,cont,data,app,title,redUrl,article,avatar,str="",focus="",selectStr='<div class="in-wiki-selector">';if(a.isFirstApp){b=O.createTab('wiki','百科','first');a.isFirstApp=false}else{b=O.createTab('wiki','百科')}data=a.data;cont=v.createElement("li");cont.className="wiki";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>相关百科</h3><div class="main-cont">';str+='<div class="in-slider-container">';for(var i=0,len=data.wikiSpot.length;i<len;i++){focus=i==0?" focus":"";app=data.wikiSpot[i];a.createSpot(app,i);avatar=app.firstimg;title=app.title;article=app.summary;redUrl=B.redurl+"?tty=1&mx="+app.metrix+"&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift="+app.type+"&at=&tg="+encodeURIComponent(encodeURIComponent(title))+"&rurl="+encodeURIComponent(encodeURIComponent(app.url));str+='<div class="wiki-item'+focus+'"><div class="left"><a class="thumb" href="'+redUrl+'" target="_blank" title="'+title+'"><img src="'+avatar+'"/></a><h3><a class="tagName" href="'+redUrl+'" target="_blank">'+title+'</a></h3></div><div class="right"><p><em class="arrow-one"></em><em class="arrow-two"></em>'+article+'</p><div class="icon-section"><a href="'+redUrl+'" target="_blank"><img src="http://static.instreet.cn/widgets/push/images/icon_baike.png"/></a></div></div></div>';if(len>1)selectStr+='<a href="javascript:;" target="_self" class="select-item'+focus+'"></a>'}str+='</div>'+selectStr+'</div></div>';cont.innerHTML=str;return{tab:b,cont:cont}},newsApp:function(a){if(!B.showNews)return;var b,c,data=a.data,w=B.width,h=B.height,newsUrl=A+"news?size="+w+"&pd="+data.widgetSid+"&muh="+data.imageUrlHash;if(a.isFirstApp){b=O.createTab('news','新闻','first');a.isFirstApp=false}else{b=O.createTab('news','新闻')}var c=v.createElement("li");c.className="news";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>热点新闻</h3><div class="main-cont">';str+='<iframe name="weather_inc" src="'+newsUrl+'" width="'+w+'" height="'+h+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>';str+='</div>';c.innerHTML=str;return{tab:b,cont:c}},weatherApp:function(a){if(!B.showWeather)return;var b,c,w=B.width,weatherUrl="http://www.thinkpage.cn/weather/weather.aspx?uid=&cid=101010100&l=zh-CHS&p=TWC&a=1&u=C&s=1&m=0&x=1&d=3&fc=&bgc=&bc=&ti=1&in=1&li=2&ct=iframe";if(a.isFirstApp){b=O.createTab('weather','天气','first');a.isFirstApp=false}else{b=O.createTab('weather','天气')}var c=v.createElement("li");c.className="weather";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>天气预报</h3><div class="main-cont">';str+='<iframe name="weather_inc" src="'+weatherUrl+'" width="'+w+'" height="110" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="true" ></iframe>';str+='</div>';c.innerHTML=str;return{tab:b,cont:c}},shareApp:function(a){if(!B.showShareButton)return;var b,c;if(a.isFirstApp){b=O.createTab('share','分享','first');a.isFirstApp=false}else{b=O.createTab('share','分享')}var c=v.createElement("li");c.className="share";str='<h3 class="title clearfix"><a title="关闭" href="javascript:;" target="_self" class="in-close">×</a>图片分享</h3><div class="main-cont">';str+='<div class="in-share-icons"><a title="新浪微博" class="sina-ico" href="javascript:;" target="_self"></a><a title="腾讯微博" class="tx-ico" href="javascript:;" target="_self"></a><a title="QQ空间" class="qzone-ico" href="javascript:;" target="_self"></a><a title="人人网" class="renren-ico" href="javascript:;" target="_self"></a><a title="搜狐微博" class="sohu-ico" href="javascript:;" target="_self"></a><a title="网易微博" class="wangyi-ico" href="javascript:;" target="_self"></a><a title="豆瓣" class="douban-ico" href="javascript:;" target="_self"></a><a title="开心网" class="kaixin-ico" href="javascript:;" target="_self"></a>';str+='</div></div>';c.innerHTML=str;return{tab:b,cont:c}}};var P=function(a){a=a||0;var b=v.getElementsByTagName('img');for(var i=0,len=b.length;i<len;i++){var c=b[i];if(c.className.indexOf('ins-shop-image')!=-1||c.insDataLoading==true||c.getAttribute('instreet_data_loading')||c.insDataLoaded==true||c.getAttribute('instreet_data_loaded')){continue}if(typeof c.insId=='undefined'){c.insId=imgs.length}c.setAttribute('instreet_img_id',c.insId);imgs[c.insId]=c;L.onImgLoad(c)}if(a<5){setTimeout(function(){P(++a)},1000)}};var Q=function(c){if(c&&typeof c=="object"){for(var i in c){B[i]=c[i]}}else{return}B.color=B.color&&B.color.toLowerCase()};function init(){if(typeof instreet_config!="undefined"){Q(instreet_config)}N.init();L.initData();C.bind(q,'load',function(){O.reLocate();P()});C.bind(q,'resize',function(){O.reLocate()});K(L.adsArray)};H(function(){init()})})(window);