/*!2013-07-11 15:07:15 */
(function(t){function e(){"undefined"!=typeof instreet_config&&(p(instreet_config,c),c.width=120,c.height=600),(r=o())&&(c.cssurl&&d.importFile("css",c.cssurl),w.requestAd(),d.bind(t,"resize",function(){E.relocate()}),x(w.adsArray))}if(!t.InstreetWidget||"object"!=typeof t.InstreetWidget){t.InstreetWidget={version:"@REVISION@",type:"InstreetImageWidget",name:"msncouplet"};var i=t.document,n=(t.navigator,t.location),a=(n.hostname,!!t.ActiveXObject,[]),r=null,o=function(){var t=i.createElement("div"),e=i.getElementsByTagName("body")[0]||i.documentElement;return t.id=t.className="instreet-image-plugin-container",e&&e.firstChild?(e.insertBefore(t,e.firstChild),t):null},s={"746YRj7kfucKZSZc3KfGo0":980},l="http://push.instreet.cn/",c={redurl:l+"click.action",callbackurl:l+"push.action",murl:l+"tracker.action",iurl:l+"tracker90.action",ourl:l+"loadImage.action",surl:l+"share/weiboshare",imih:300,imiw:300,timer:1e3,width:120,height:600,adsLimit:1},d={bind:function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},remove:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.datachEvent?t.datachEvent("on"+e,i):t["on"+e]=null},getEvent:function(e){return e?e:t.event},getTarget:function(t){return t.target||t.srcElement},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},getRelatedTarget:function(t){return t.relatedTarget?t.relatedTarget:"mouseover"==t.type?t.fromElement:"mouseout"==t.type?t.toElement:null},getXY:function(t){var e=0,n=0;if(t.getBoundingClientRect){var a=t.getBoundingClientRect(),r=i.documentElement;e=a.left+Math.max(r.scrollLeft,i.body.scrollLeft)-r.clientLeft,n=a.top+Math.max(r.scrollTop,i.body.scrollTop)-r.clientTop}else for(;t!=i.body;e+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent);return{x:e,y:n}},aTrim:function(t){function e(t,e){return t-e}var i=[];t.sort(e);for(var n=t.length,a=0,r=0;n>r;r++)t[r]!=t[r+1]&&(i[a]=t[r],a++);return i},$:function(t,e,n){var a,r=t||i;if(2==arguments.length?(n=e,a="*"):a=e||"*",i.getElementsByClassName)return r.getElementsByClassName(n);for(var o=[],s=r.getElementsByTagName(a),l=s.length,c=l;c--;){var d=s[c];if(d.className)for(var h=d.className.replace(/\s/g,"|").split("|"),u=h.length,p=u;p--;)if(h[p]==n){o.push(d);break}}return o},importFile:function(t,e){var n,a,r=i.getElementsByTagName("head")[0]||i.documentElement;switch(t){case"js":a=i.createElement("script"),a.async="async",a.charset="utf-8",a.type="text/javascript",a.onload=a.onreadystatechange=function(){a.readyState&&"loaded"!==a.readyState&&"complete"!==a.readyState||(a.onload=a.onreadystatechange=null,r&&a.parentNode&&r.removeChild(a))},a.src=e,r.appendChild(a);break;case"css":n=i.createElement("link"),n.type="text/css",n.rel="stylesheet",n.href=e,r.appendChild(n)}},hasClass:function(t,e){if(t.className)for(var i=t.className.split(" "),n=0,a=i.length;a>n;n++)if(e===i[n])return!0;return!1},isVisible:function(e){if(e==i)return!0;if(!e)return!1;if(!e.parentNode)return!1;if(e.style){if("none"==e.style.display)return!1;if("hidden"==e.style.visibility)return!1}var n=null;if(t.getComputedStyle){if(n=t.getComputedStyle(e,""),"none"==n.display)return!1;if("hidden"==n.visibility)return!1}if(n=e.currentStyle){if("none"==n.display)return!1;if("hidden"==n.visibility)return!1}return d.isVisible(e.parentNode)}},h=function(t,e){if(t)if(t.length)for(var i=0,n=t.length;n>i;i++)e.call(t[i],i);else t&&e.call(t,0)},u=function(t){h(t,function(){this.style.display="none"})},p=function(t,e){if(t)if("object"==typeof t)for(var i in t)e[i]=t[i];else"function"==typeof t&&(e[t]=t)},f=[],m=!1,g=/^(loaded|complete)$/,v=function(){if(!m){for(var t=0;f.length>t;t++)f[t]&&f[t].call(i);m=!0,f=null}},y=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",y,!1),v()):g.test(i.readyState)&&(i.detachEvent("onreadystatechange",y),v())},b=function(e){return"complete"===i.readyState?(v(),undefined):(f.push(e)>1||(i.addEventListener?(i.addEventListener("DOMContentLoaded",y,!1),t.addEventListener("loaded",v,!1)):i.attachEvent&&(i.attachEvent("onreadystatechange",y),t.attachEvent("onload",v))),undefined)},w={adsArray:[],requestAd:function(){for(var t=i.getElementsByTagName("img"),e=0,n=t.length;n>e;e++){var r=t[e];a[e]=r,r.insId=e,r.setAttribute("instreet_img_id",e),w.imgLoadHandle(r)}},imgLoadHandle:function(t){var e=new Image;e.src=t.src,e.insId=t.insId,e.complete?w.loadData(e):e.onload=function(){var t=this;t.onload=null,w.loadData(e)}},loadData:function(t){var e=t.insId,i=a[e];if(t.width>=c.imiw&&t.height>=c.imih&&(i.clientWidth>=c.imiw&&i.clientHeight>=c.imih||0===i.clientWidth&&0===i.clientHeight)){if("number"==typeof c.adsLimit&&0>=c.adsLimit)return;i.setAttribute("instreet_data_loading",!0),i.insDataLoading=!0,w.createJsonp(i),c.adsLimit&&c.adsLimit--}},createJsonp:function(t){var e=c.width||250,i=c.height||250,n=encodeURIComponent(encodeURIComponent(t.src)),a=c.callbackurl+"?index="+t.insId+"&pd="+c.widgetSid+"&iu="+n+"&callback=insjsonp"+"&w="+e+"&h="+i;d.importFile("js",a)}},E=function(t,e){this.data=e,this.img=a[e.index],this.param={width:c.width,height:c.height,initSrc:this.img.src,prevSrc:""},this.switchCount=0,this.init(t)};E.relocate=function(){for(var t in w.adsArray)w.adsArray[t]&&w.adsArray[t].locate()},p({init:function(t){this.createCouplet(t),this.fillContent(),this.locate(),this.bindEvent()},createCouplet:function(t){var e=this.param.width,n=this.param.height,a="display:none;position:fixed;_position:absolute;width:"+e+"px;height:"+n+"px;border:1px solid #ddd;background-color:#EEE;padding:2px;cursor:pointer;z-index:2147483647",r=i.createElement("div"),o=i.createElement("div");r.style.cssText=o.style.cssText=a,r.innerHTML=o.innerHTML='<a class="ins-btn-close" title="关闭" style="position:absolute;top:3px;right:3px;width:12px;height:12px;line-height:11px;border-radius:50%;background-color:#EEE;color:#888;text-align:center;cursor: pointer;text-decoration:none;z-index:19;">×</a>',this.leftCouplet=r,this.rightCouplet=o,t.appendChild(r),t.appendChild(o)},fillContent:function(){var t=this.data,e=this.param.width,n=this.param.height;t={left:{src:"http://static.instreet.cn/bdpic/msn_couplet_demo.swf",type:"flash",directUrl:"http://www.instreet.cn"},right:{src:"http://static.instreet.cn/bdpic/msn_couplet_demo.swf",type:"flash",directUrl:"http://www.instreet.cn"}};var a=function(a){var r=i.createElement("div");switch(r.style.position="relative",a.type){case"flash":r.innerHTML='<div><object width="'+e+'" height="'+n+'" align="middle" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"><param value="always" name="allowScriptAccess"/><param value="'+a.src+'" name="movie"/><param value="high" name="quality"/><param value="opaque" name="wmode"/><embed width="'+e+'" height="'+n+'" align="middle" pluginspage="http://www.adobe.com/go/getflashplayer" type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque" quality="high" src="'+a.src+'"></embed></object></div>'+'<a href="'+a.directUrl+'" target="_blank" style="position:absolute;top:0;left:0;width:'+e+"px;height:"+n+'px;z-index:10;background-color:#FFF;opacity:0;filter:alpha(opacity=0)"></a>';break;case"image":r.innerHTML='<a href="'+a.directUrl+'"><img width="'+e+'" height="'+n+'" src="'+t.src+'"/></a>'}return r};this.leftCouplet.appendChild(a(t.left)),this.rightCouplet.appendChild(a(t.right))},locate:function(){function t(){return l>=p?(m=l-p+"px",o>f&&(g=(o-f)/2+"px"),d.closed||(d.style.cssText+=";display:block;top:"+g+";left:"+m+";"),h.closed||(h.style.cssText+=";display:block;top:"+g+";right:"+m+";"),undefined):(u(d),u(h),undefined)}var e=s[c.widgetSid]||980,n=i.documentElement,a=i.body,r=n.clientWidth||a.clientWidth,o=n.clientHeight||a.clientHeight,l=(r-e)/2,d=this.leftCouplet,h=this.rightCouplet,p=this.param.width+6,f=this.param.height+6,m=0,g=0;clearTimeout(this.locateTimer),this.locateTimer=setTimeout(t,100)},bindEvent:function(){var t=this.leftCouplet,e=this.rightCouplet,i=d.$(t,"ins-btn-close")[0],n=d.$(e,"ins-btn-close")[0];i.onclick=function(){u(t),t.closed=!0},n.onclick=function(){u(e),e.closed=!0}},destroy:function(){var t=this.leftCouplet.parentNode;t&&t.removeChild(this.leftCouplet)&&t.removeChild(this.rightCouplet)},isImgChanged:function(){var t=this.img;return t.src&&t.src!=this.param.initSrc?(this.param.prevSrc=this.param.initSrc,this.param.initSrc=t.src,!0):!1}},E.prototype);var C=5,x=function(t){setInterval(function(){for(var e in t){var i=t[e];if(i&&i.isImgChanged()&&i.img.src!=i.param.prevSrc){var n=i.img;if(i.switchCount==C){i.destroy(),t[e]=null,c.adsLimit++,w.imgLoadHandle(n);break}i.switchCount++}}},100)};t.insjsonp=function(t){if(t){var e=t.index,i=a[e];i.insDataLoaded=!0,i.setAttribute("instreet_data_loaded",!0);var n=new E(r,t);w.adsArray[e]=n}},b(function(){e()})}})(window);