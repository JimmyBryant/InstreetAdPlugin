/*!2013-07-04 */
(function(e,t){if(e.InstreetWidget!==t||null!=e.InstreetWidget)return!1;e.InstreetWidget={version:"@REVISION@",name:"InstreetWidget"};var a,n=e.document,s=(e.navigator,e.location),r=(!!e.ActiveXObject,[]),o=[],l=[],c=[250,250],d=["red","yellow","green","blue","purple","brown"],p="http://push.instreet.cn/",h={redurl:p+"click.action",callbackurl:p+"push.action",murl:p+"tracker.action",iurl:p+"tracker90.action",ourl:p+"loadImage.action",surl:p+"share/weiboshare",cssurl:"http://static.instreet.cn/widgets/push/css/instreet.metro.min.css",imih:300,imiw:300,timer:2e3,sizeNum:0},m=function(i){var a=function(){for(var e=0;l.length>e;e++)l[e]&&l[e]()},s=function(){try{n.documentElement.doScroll("left")}catch(e){return setTimeout(s,50),t}a()},r=!!e.ActiveXObject;return"complete"===n.readyState?(l.push(i),a(),t):l.push(i)>1?t:n.addEventListener?n.addEventListener("DOMContentLoaded",a,!1):(r&&s(),t)},u={get:function(t,i){var a=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,s=RegExp("^("+a+")(?!px)[a-z%]+$","i"),r=/^(top|right|bottom|left)$/,o=/opacity=([^)]*)/,l=/^margin/,c=function(e,t){var i="width"===t?e.clientWidth:e.clientHeight,a=parseFloat(u.get(e,"paddingTop")),n=parseFloat(u.get(e,"paddingBottom")),s=parseFloat(u.get(e,"paddingLeft")),r=parseFloat(u.get(e,"paddingRight"));return i=("width"===t?i-s-r:i-a-n)+"px"};if(e.getComputedStyle){var d,p,h,m,f=e.getComputedStyle(t,null),g=t.style;return i="float"===i?"cssFloat":i,f&&(d=f[i],s.test(d)&&l.test(i)&&(p=g.width,h=g.minWidth,m=g.maxWidth,g.minWidth=g.maxWidth=g.width=d,d=f.width,g.width=p,g.minWidth=h,g.maxWidth=m)),d}if(n.documentElement.currentStyle){var v,b,d=t.currentStyle&&t.currentStyle[i],g=t.style;return i="float"===i?"styleFloat":i,"opacity"===i?o.test((t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":f?"1":"":"width"!==i&&"height"!==i||"auto"!==t.currentStyle[i]?(null==d&&g&&g[i]&&(d=g[i]),s.test(d)&&!r.test(i)&&(v=g.left,b=t.runtimeStyle&&t.runtimeStyle.left,b&&(t.runtimeStyle.left=t.currentStyle.left),g.left="fontSize"===i?"1em":d,d=g.pixelLeft+"px",g.left=v,b&&(t.runtimeStyle.left=b)),""===d?"auto":d):d=c(t,i)}return t.style[i]},set:function(i,a,n){if("object"!=typeof a||n!==t)e.getComputedStyle?a="float"===a?"cssFloat":a:(a="float"===a?"styleFloat":a,"opacity"===a&&(i.style.filter="alpha(opacity="+100*n+")")),i.style[a]=n;else for(var s in a)u.set(i,s,a[s])}},f=function(t){var a,n=[],s=e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame,r=function(e){for(var t in e)return!1;return!0},o=function(e){return this.elem=e,this};o.prototype.animate=function(e,t,i,a){var n=this.elem,s=o.getOpt(t,i,a);if(n&&1==n.nodeType){var c;if(e&&"object"==typeof e)if(r(e))s.callback.call(n);else{s.animatedProperties={};for(var d in e)s.animatedProperties[d]=!1;for(var p in e){var h=new l(n,s,p);c=parseFloat(u.get(n,p)),end=parseFloat(e[p]),h.custom(c,end)}}}},o.prototype.fadeIn=function(e,t,i){var a=this,n=a.elem;"none"==u.get(n,"display")&&u.set(n,{opacity:0,display:"block"}),a.animate({opacity:1},e,t,i)},o.prototype.fadeOut=function(e,t,i){var a=this,n=a.elem;e=e||400,t=t||"swing",a.animate({opacity:0},e,t,function(){u.set(n,"display","none"),i&&i()})},o.prototype.stop=function(e){var t=this.elem;e=e||!1;for(var i=0;n.length>i;i--){var a=n[i];a.elem===t&&(e&&a.update(a.name,a.end),n.splice(i--,1))}return this},o.getOpt=function(e,t,i){var a={};return a.duration=e,a.callback=i||t||e,a.old=a.callback,a.easing=i&&t||t||e,a.callback=function(){"function"==typeof a.old&&a.old.call(this)},a.duration="number"==typeof a.duration?a.duration:400,a.easing="string"==typeof a.easing?a.easing:"swing",a};var l=function(e,t,i){this.elem=e,this.options=t,this.name=i};l.interval=13,l.prototype.custom=function(e,t){function i(e){return o.step(e)}var i,r,o=this;this.startTime=(new Date).getTime(),this.start=e,this.end=t,i.elem=this.elem,i()&&n.push(i)&&!a&&(s?(a=!0,r=function(){a&&(s(r),l.tick())},s(r)):a=setInterval(l.tick,l.interval))},l.prototype.step=function(){var e,t=(new Date).getTime(),a=!0,n=this.options;if(t>n.duration+this.startTime){e=this.end,n.animatedProperties[this.name]=!0;for(i in n.animatedProperties)n.animatedProperties[i]!==!0&&(a=!1);return a&&n.callback.call(this.elem),this.update(this.name,e),!1}var s=t-this.startTime,r=s/n.duration,o=c[n.easing](r,0,1,n.duration);return e=this.start+(this.end-this.start)*o,this.update(this.name,e),!0},l.prototype.update=function(e,t){"opacity"!=e&&(t+="px"),u.set(this.elem,e,t)},l.tick=function(){for(var e=0;n.length>e;++e)n[e]()||n.splice(e--,1);n.length||l.stop()},l.stop=function(){clearInterval(a),a=null};var c={linear:function(e){return e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5}};return new o(t)},g={bind:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},remove:function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.datachEvent?e.datachEvent("on"+t,i):e["on"+t]=null},getEvent:function(t){return t?t:e.event},getTarget:function(e){return e.target||e.srcElement},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getRelatedTarget:function(e){return e.relatedTarget?e.relatedTarget:"mouseover"==e.type?e.fromElement:"mouseout"==e.type?e.toElement:null},getXY:function(e){var t=0,i=0;if(e.getBoundingClientRect){var a=e.getBoundingClientRect(),s=n.documentElement;t=a.left+Math.max(s.scrollLeft,n.body.scrollLeft)-s.clientLeft,i=a.top+Math.max(s.scrollTop,n.body.scrollTop)-s.clientTop}else for(;e!=n.body;t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent);return{x:t,y:i}},aTrim:function(e){function t(e,t){return e-t}var i=[];e.sort(t);for(var a=e.length,n=0,s=0;a>s;s++)e[s]!=e[s+1]&&(i[n]=e[s],n++);return i},$:function(e){return n.getElementById(e)},$$:function(e,t,i){var a,s=e||n;if(2==arguments.length)i=t,a="*";else var a=t||"*";if(n.getElementsByClassName)return s.getElementsByClassName(i);for(var r=[],o=s.getElementsByTagName(a),l=o.length,c=l;c--;){var d=o[c];if(d.className)for(var p=d.className.replace(/\s/g,"|").split("|"),h=p.length,m=h;m--;)if(p[m]==i){r.push(d);break}}return r},createElem:function(e){return n.createElement(e)},importFile:function(e,t){var i,a,s=n.getElementsByTagName("head")[0]||n.documentElement;switch(e){case"js":a=g.createElem("script"),a.async="async",a.charset="utf-8",a.type="text/javascript",a.onload=a.onreadystatechange=function(){a.readyState&&"loaded"!==a.readyState&&"complete"!==a.readyState||(a.onload=a.onreadystatechange=null,s&&a.parentNode&&s.removeChild(a))},a.src=t,s.appendChild(a);break;case"css":i=g.createElem("link"),i.type="text/css",i.rel="stylesheet",i.href=t,s.appendChild(i)}},isVisible:function(t){if(t==n)return!0;if(!t)return!1;if(!t.parentNode)return!1;if(t.style){if("none"==t.style.display)return!1;if("hidden"==t.style.visibility)return!1}if(e.getComputedStyle){var i=e.getComputedStyle(t,"");if("none"==i.display)return!1;if("hidden"==i.visibility)return!1}var i=t.currentStyle;if(i){if("none"==i.display)return!1;if("hidden"==i.visibility)return!1}return g.isVisible(t.parentNode)},getCookie:function(e){var i=e+"=";return n.cookie.length>0?(offset=n.cookie.indexOf(i),-1!=offset?(offset+=i.length,end=n.cookie.indexOf(";",offset),-1==end&&(end=n.cookie.length),unescape(n.cookie.substring(offset,end))):""):t},setCookie:function(e,t){var i=arguments.length,a=i>2?arguments[2]:null;if(null!=a){var s=new Date;s.setTime(s.getTime()+24*3600*1e3*a)}n.cookie=e+"="+escape(t)+(null==a?"":"; expires="+s.toGMTString())}};e.ins_image_jsonp=function(e){if(!e||1!=e.image_context_sensi){var t=imgs[e.index];"number"==typeof h.adsLimit&&0>=h.adsLimit||(t.setAttribute("instreet_data_loading",!0),t.insDataLoading=!0,cache.createJsonp(t),h.adsLimit&&h.adsLimit--)}},e.insjsonp=function(e){if(e){var t=e.index,i=o[t];i.setAttribute("instreet_data_ready",!0),i.insDataReady=!0,v(t);var n=new x(e,a);r[t]=n}};var v=function(e){if(r[e]){var t=r[e],i=t.box.parentNode,a=t.controlBox.parentNode;i&&i.removeChild(t.box),a&&a.removeChild(t.controlBox)}};recordImage=function(t){var i=encodeURIComponent(encodeURIComponent(t.src)),a=h.widgetSid,s=(encodeURIComponent(encodeURIComponent(e.location.href)),encodeURIComponent(encodeURIComponent(n.title))),r=h.ourl,o=t.insIndex,l=(new Date).getTime();r+="?iu="+i+"&pd="+a+"&t="+s+"&index="+o+"&time="+l,g.importFile("js",r)};var b=function(e){var i=function(e,i){var a=new Image;e.src!==t&&(a.src=e.src,a.insIndex=e.insIndex,a.complete?i&&i(a):a.onload=function(){var e=this;e.onload=null,i&&i(a)})},a=function(e){var i=e.insIndex,a=o[i];e.width>=h.imiw&&e.height>=h.imih&&(a.clientWidth>=h.imiw&&a.clientHeight>=h.imih||0==a.clientWidth&&0==a.clientHeight)&&(recordImage(a),(a.naturalWidth===t||a.naturalHeight===t)&&(a.naturalWidth=e.width,a.naturalHeight=e.height))};i(e,a)},w=function(e,t){for(var i in t)e[i]=t[i]},y=function(e){g.setCookie("instreet_theme",e,7);for(var t in r){var i=r[t];if(i.box&&i.box.lastChild){i.box.lastChild.className="ins-wrapper ins-"+d[e]+"style ins-size"+c[2*h.sizeNum],i.controlBox.firstChild.className="ins-"+d[e]+"style",i.close.className="ins-btn-close ins-btn-"+d[e]+"style";var a=i.footer,n=g.$$(a,"selected")[0];n.className="",a.getElementsByTagName("li")[e].className="selected"}}h.theme=e},x=function(e,t){var i=o[e.index];this.insIndex=e.index,this.adsData=e,this.container=t,this.image=i,this.spotsArray=[],this.timer=null,this.timerApp=null,this.isFirstShow=!0,this.isOn=!0,this.init()};x.fn=x.prototype,w(x.fn,{init:function(){var t=this;t.createController(),t.createContainer(),t.createApps(),t.locate(),g.bind(e,"resize",function(){t.locate()})},createController:function(){var t,i=this,a=g.createElem("div"),r=g.createElem("div"),o=g.createElem("div"),l="";a.className="instreet-plugin-control",r.className="ins-"+d[h.theme]+"style",o.className="ins-control",u.set(a,"display","none"),l+='<a href="javascript:;" target="_self" class="ins-icon ins-icon-control"></a><div class="ins-bubble"><dl><dt><em class="ins-arrow-top"></em></dt><dd><p>尚街已开启</p></dd></dl></div>',o.innerHTML=l,r.appendChild(o);var c=function(e){var t=g.getEvent(e),i=g.getRelatedTarget(t);this.contains(i)||(this.timer&&clearTimeout(this.timer),f(this.lastChild).stop().fadeIn())},p=function(e){var t=g.getEvent(e),i=g.getRelatedTarget(t);if(!this.contains(i)){var a=this;a.timer=setTimeout(function(){f(a.lastChild).fadeOut()},500)}};h.showShareButton&&(t=g.createElem("div"),t.className="ins-share",t.innerHTML='<a href="javascript:;" target="_self" title="分享图片" class="ins-icon ins-icon-share"></a><div class="ins-bubble"><dl><dt><em class="ins-arrow-top"></em></dt><dd><a href="javascript:;" target="_self" class="ins-share-sina" title="新浪微博"></a><a href="javascript:;" target="_self" class="ins-share-tx" title="腾讯微博"></a><a href="javascript:;" target="_self" class="ins-share-qz" title="QQ空间"></a><a href="javascript:;" target="_self" class="ins-share-renren" title="人人网"></a></dd></dl></div>',r.appendChild(t),i.share=t,t.onmouseover=c,t.onmouseout=p,t.onclick=function(t){var a=g.getEvent(t),r=g.getTarget(a);if("A"==r.tagName&&-1!=r.className.indexOf("ins-share-")){var o=encodeURIComponent(i.image.src),l=r.className.replace("ins-share-",""),c=i.adsData.widgetSid,d=(new Date).getTime(),p=encodeURIComponent(n.title),m=encodeURIComponent(s.href),u=h.surl+"?content=''&imgUrl="+encodeURIComponent(o)+"&widgetSid="+c+"&pageUrl="+encodeURIComponent(s.href)+"&shareTo="+l+"&time="+d,f="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=580, height=500";switch(r.className){case"ins-share-sina":e.open("http://v.t.sina.com.cn/share/share.php?title="+p+"&url="+m+"&pic="+o,"_blank",f);break;case"ins-share-tx":e.open("http://share.v.t.qq.com/index.php?c=share&a=index&title="+p+"&url="+m+"&pic="+o,"_blank",f);break;case"ins-share-qz":e.open("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?showcount=1&url="+m+"&title="+p+"&pics="+o+"&summary=","_blank",f);break;case"ins-share-renren":e.open("http://share.renren.com/share/buttonshare.do?link="+m,"_blank",f)}g.importFile("js",u)}}),a.appendChild(r),i.container.appendChild(a),i.controlBox=a,i.control=o,o.onmouseover=c,o.onmouseout=p,g.bind(o.firstChild,"click",function(){var e=o.getElementsByTagName("p")[0];1==i.isOn?(x.slideIn(i),i.isOn=!1,e.innerHTML="尚街已关闭"):(x.slideOut(i),i.isOn=!0,e.innerHTML="尚街已开启",i.recordShow(9))})},createContainer:function(){var e=this,t=c[2*h.sizeNum],i=g.createElem("div"),a=g.createElem("a"),s=g.createElem("div"),r=n.createDocumentFragment(),o=g.createElem("div"),l=g.createElem("div"),p=g.createElem("ul"),m=g.createElem("div"),f=e.createFooter();i.className="instreet-plugin-box",a.className="ins-btn-close ins-btn-"+d[h.theme]+"style",a.href="javascript:;",a.title="关闭广告",a.target="_self",a.innerHTML="×",s.className="ins-wrapper ins-"+d[h.theme]+"style ins-size"+t,u.set(i,"display","none"),u.set(s,"width",0),u.set(a,"display","none"),o.className="ins-colorline clearfix",l.className="ins-borderbox",p.className="ins-main-nav",m.className="ins-main-content",r.appendChild(o),r.appendChild(p),r.appendChild(m),r.appendChild(f),l.appendChild(r),s.appendChild(l),i.appendChild(a),i.appendChild(s),e.container.appendChild(i),e.close=a,e.nav=p,e.content=m,e.footer=f,e.box=i},createApps:function(){var e=this,t=null;e.box;var i=function(){var t=g.$$(e.box,"ins-colorline")[0],i=e.nav.children.length;t.className+=" ins-column"+i,str="",i=5==i?i:4==i?i:6;for(var a=0;i>a;a++)str+='<span class="'+d[a]+'"></span>';t.innerHTML=str},a=function(){clearTimeout(t),e.isOn&&(e.recordShow(10),x.slideOut(e))},n=function(){e.isOn&&(t=setTimeout(function(){x.slideIn(e)},h.timer))};for(var s in x.apps)x.apps[s]&&x.apps[s](e);i(),g.bind(e.image,"mouseover",a),g.bind(e.image,"mouseout",n),g.bind(e.box,"mouseover",a),g.bind(e.box,"mouseout",n),g.bind(e.close,"click",function(){x.slideIn(e)}),e.content.onmouseover=function(t){var i=g.getEvent(t),a=g.getRelatedTarget(i);this.contains(a)||e.recordWatch()},g.bind(e.controlBox,"mouseover",function(){clearTimeout(t)}),e.nav.className+=" ins-nav"+e.nav.children.length,e.content.firstChild.className+=" content-item-selected"},createNavItem:function(e,t){var i=this,a=g.createElem("li");a.className=i.nav.children.length?"nav-item":"nav-item first selected",a.innerHTML='<div><em class="icon-'+e+'"></em><span>'+t+"</span></div>",i.nav.appendChild(a);var n=null;a.onmouseover=function(){if(-1==this.className.indexOf("selected")){var t=this;n=setTimeout(function(){var a=g.$$(i.nav,"selected")[0],n=g.$$(i.content,"content-item-selected")[0],s=g.$$(i.content,e+"-item")[0],r=i.nav.parentNode,o=r.parentNode;a.className=a.className.replace(" selected",""),t.className+=" selected",f(n).stop(!0).animate({opacity:0},200,function(){this.className=this.className.replace(" content-item-selected",""),s.className+=" content-item-selected",u.set(s,{opacity:1}),u.set(o,"height",u.get(r,"height")),i.recordShow(9)})},200)}},a.onmouseout=function(){clearTimeout(n),n=null}},createFooter:function(){var e=g.createElem("div"),t=e.getElementsByTagName("li");return e.className="ins-footer",e.innerHTML='<div>Powered by <a target="_blank" href="http://www.instreet.cn" title="尚街网">Instreet</a><ul class="theme-list"><li><a class="red" index="0" href="javascript:;" target="_self"></a></li><li><a class="yellow" index="1" href="javascript:;" target="_self"></a></li><li><a class="green" index="2" href="javascript:;" target="_self"></a></li><li><a class="blue" index="3" href="javascript:;" target="_self"></a></li><li><a class="purple" index="4" href="javascript:;" target="_self"></a></li><li><a class="brown" index="5" href="javascript:;" target="_self"></a></li></ul></div>',t[h.theme].className="selected",e.onclick=function(e){var t=g.getEvent(e),i=g.getTarget(t);if("LI"==i.parentNode.tagName||"LI"==i.tagName){var a="LI"==i.tagName?i.firstChild.getAttribute("index"):i.getAttribute("index");h.theme!=a&&y(a)}},e},locate:function(){var i=this;clearTimeout(i.timer),i.timer=setTimeout(function(){var a=i.image,s=g.getXY(a),r=c[2*h.sizeNum]+18,o=parseFloat(u.get(i.box,"height")),l=s.y+"px",d=s.y+a.clientHeight-o,p=Math.max(n.body.clientWidth,n.documentElement.clientWidth),m=e.pageYOffset||n.documentElement.scrollTop||0;if(i.imageInfo={width:a.clientWidth,height:a.clientHeight,x:s.x,y:s.y,scrollTop:m,src:a.src},!g.isVisible(a)||a.clientWidth<h.imiw||a.clientHeight<h.imih)return u.set(i.controlBox,"display","none"),u.set(i.box,"display","none"),t;m>d?l=d+"px":m>s.y&&d>=m&&(l=m+"px");var f=function(){var e=p-s.x-a.clientWidth+"px";u.set(i.box,{top:l,right:e,left:"auto"}),u.set(i.box.lastChild.lastChild,{left:0,right:"auto"})},v=function(){var e=s.x+a.offsetWidth+"px";u.set(i.box,{top:l,left:e,right:"auto"}),u.set(i.box.lastChild.lastChild,{left:"auto",right:0})};1==h.outPosition?f():2==h.outPosition?v():s.x+a.clientWidth+r>p?f():v(),g.isVisible(a)&&a.clientWidth>=h.imiw&&a.clientHeight>=h.imih&&(u.set(i.controlBox,{top:s.y+5+"px",left:s.x+5+"px",display:"block"}),u.set(i.box,"display","block")),h.footAuto&&i.isFirstShow&&(i.recordShow(9),x.slideOut(i),i.isFirstShow=!1)},100)},checkLocation:function(){var i=this,a=i.image,s=g.getXY(a),r=i.imageInfo,o=e.pageYOffset||n.documentElement.scrollTop||0;if(r!==t){if(0>=a.clientWidth||0>=a.clientHeight)for(var l=n.images,c=l.length;c--;)if(l[c].src==a.src&&l[c].clientWidth>=h.imiw&&l[c].clientHeight>=h.imih&&a.insIndex==l[c].getAttribute("instreet_img_id"))return l[c].insIndex=a.insIndex,i.image=l[c],i.locate(),t;a.src!==t&&a.src!=r.src?(r.src=a.src,v(i.insIndex),"number"==typeof h.adsLimit&&h.adsLimit++,b(a)):(s.x!==r.x||s.y!==r.y||o!==r.scrollTop||a.clientWidth!==r.width||a.clientHeight!==r.height)&&i.locate()}},recordShow:function(e){var t=this,i=t.adsData,a=t.image,n=h.iurl,s=i.widgetSid,r=i.imageUrlHash,o=encodeURIComponent(encodeURIComponent(a.src)),l="",c="",d=0,p="",m=(new Date).getTime(),u=parseFloat(t.box.lastChild.style.width);if(!(10==e&&u>0)){var f=g.$$(t.content,"content-item-selected")[0];if(f){if(-1!=f.className.indexOf("ad-item")){var v=i.badsSpot[0];l=v.adsId,c=v.adsType,v.adViewMonitorUrl&&g.importFile("js",v.adViewMonitorUrl+"?time="+m)}else if(-1!=f.className.indexOf("shop-item")){d=t.getSelectedIndex();var v=i.adsSpot[d];l=v.adsId,c=v.adsType,p=v.metrix}else if(9==e)return}else if(9==e)return;n+="?pd="+s+"&mx="+p+"&muh="+r+"&iu="+o+"&ad="+l+"&at="+c+"&flag="+e+"&time="+m,g.importFile("js",n)}},recordWatch:function(){var e=this,t=e.adsData,i=e.image,a=encodeURIComponent(encodeURIComponent(i.src)),n=t.widgetSid,s=h.murl,r=(t.imageNumId||"",t.imageUrlHash),o="",l="",c=0,d=1,p="",m=g.$$(e.content,"content-item-selected")[0],u=m.className;if(-1!=u.indexOf("shop-item")){var f=e.getSelectedIndex(),v=t.adsSpot[f];o=v.adsId,l=v.adsType,p=v.metrix,d=0}else if(-1!=u.indexOf("ad-item"))o=t.badsSpot[0].adsId,l=t.badsSpot[0].adsType,d=0;else if(-1!=u.indexOf("weibo-item"))c=2;else if(-1!=u.indexOf("wiki-item"))c=4;else if(-1!=u.indexOf("weather-item"))c=7;else{if(-1==u.indexOf("news-item"))return;c=5}var b=(new Date).getTime();s+="?iu="+a+"&mx="+p+"&pd="+n+"&muh="+r+"&ad="+o+"&at="+l+"&tty="+d+"&ift="+c+"&time="+b,g.importFile("js",s)},getSelectedIndex:function(){var e,t=this,i=g.$$(t.content,"slider-nav")[0];return e=i&&g.$$(i,"selected")[0],e?e.getAttribute("index"):0}}),x.slideOut=function(e){var t=e,i=t.box,a=i.lastChild,n=a.lastChild,s=parseFloat(u.get(a,"width")),r=u.get(n,"width"),o=u.get(n,"height");f(t.control.firstChild).fadeIn(),t.share&&f(t.share.firstChild).fadeIn(),0>=s&&(u.set(a,"height",o),f(a).animate({width:r},300,function(){u.set(i.firstChild,"display","block")}))},x.slideIn=function(e){var t=e,i=t.box,a=i.lastChild;f(t.control.firstChild).animate({opacity:.7}),t.share&&f(t.share.firstChild).fadeOut(),f(a).animate({width:0},function(){u.set(i.firstChild,"display","none")})},x.apps={adApp:function(e){if(h.showFootAd&&0!=e.adsData.badsSpot.length){e.createNavItem("ad","推广");var t,i=e.adsData,a=i.badsSpot[0],n=g.createElem("div"),s="",r=c[2*h.sizeNum],o=c[2*h.sizeNum+1];if(n.className="content-item ad-item",a.adClickMonitorUrl){var l=a.adClickMonitorUrl+encodeURIComponent(a.adsLinkUrl||"");t=h.redurl+"?tty=0&mx=&muh="+i.imageUrlHash+"&pd="+i.widgetSid+"&ift=&at="+(a.adsType||"")+"&ad="+(a.adsId||"")+"&rurl="+encodeURIComponent(encodeURIComponent(l))}else t=h.redurl+"?tty=0&mx=&muh="+i.imageUrlHash+"&pd="+i.widgetSid+"&ift=&at="+(a.adsType||"")+"&ad="+(a.adsId||"")+"&rurl="+encodeURIComponent(encodeURIComponent(a.adsLinkUrl||""));if(3==a.adsType)s='<a class="ad-thumb" target="_blank" href="'+t+'"><img src="'+a.adsPicUrl+'" alt=""/></a>';else if(9==a.adsType)s+='<object id="afg-adloader" width="'+r+'" height="'+o+'"  align="middle" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">',s+='<param value="always" name="allowScriptAccess"/><param value="'+a.adsPicUrl+'" name="movie"/><param value="high" name="quality"/><param value="opaque" name="wmode"/><param value="high" name="quality"><param value="#F1F1F1" name="bgcolor"/>',s+='<embed width="'+r+'" height="'+o+'" align="middle" pluginspage="http://www.adobe.com/go/getflashplayer"  type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque"  bgcolor="#F1F1F1" quality="high" src="'+a.adsPicUrl+'"></object>',s+='<a class="ad-flashcover" href="'+t+'" target="_blank"></a>';else if(!a.adsLinkUrl&&a.description){var d='<iframe src="'+a.description+'" scrolling="no" height="'+a.adsHeight+'" width="'+a.adsWidth+'" frameborder="0" border="0" marginwidth="0" marginheight="0"></iframe>';s+='<i class="small-info"></i>'+d}n.innerHTML=s,e.content.appendChild(n)}},shopApp:function(e){if(h.showAd&&0!=e.adsData.adsSpot.length){e.createNavItem("shop","折扣");var t,i,a,n,s,r,o=e.adsData,l=g.createElem("div"),d=g.createElem("div"),p=g.createElem("ul");l.className="content-item shop-item",d.className="album-list",p.className="slider-nav";for(var m=0,v=o.adsSpot.length;v>m;m++){var b=g.createElem("a");r=o.adsSpot[m],t=h.redurl+"?tty=0&mx="+r.metrix+"&muh="+o.imageUrlHash+"&pd="+r.widgetSid+"&ift=&at="+r.adsType+"&ad="+r.adsId+"&rurl="+encodeURIComponent(encodeURIComponent(r.adsLinkUrl)),i=r.adsTitle,s=r.nick,a=r.adsDiscount||r.adsPrice,n=r.adsPicUrl.replace("160x160",c[2*h.sizeNum]+"x"+c[2*h.sizeNum]),b.className="product-album",b.target="_blank",b.href=t,b.innerHTML='<img alt="'+i+'" src="'+n+'"><span class="product-info"><em class="price">￥'+a+'</em><em class="name">'+i+'</em><em class="nick">'+s+"</em>",v>1&&(p.innerHTML+='<li class="switch-trigger" index="'+m+'"></li>'),d.appendChild(b)}l.appendChild(d),l.appendChild(p),d.firstChild.className+=" selected",p.firstChild&&(p.firstChild.className+=" selected"),e.content.appendChild(l),p.onmouseover=function(t){var i=g.getEvent(t),a=g.getTarget(i),n=g.$$(this,"selected")[0],s=parseFloat(u.get(d.firstChild,"width"));if("switch-trigger"==a.className){n.className="switch-trigger",a.className+=" selected";var r=-parseInt(a.getAttribute("index"))*s;f(d).animate({left:r},function(){e.recordWatch()})}}}},weiboApp:function(e){if(h.showWeibo&&0!=e.adsData.weiboSpot.length){e.createNavItem("weibo","微博");var t,i,a,n,s,r=e.adsData,o=g.createElem("div"),l=g.createElem("ul"),c="",d="";o.className="content-item weibo-item",l.className="ins-weibo-list";for(var p=0,m=r.weiboSpot.length;m>p;p++){for(var u=r.weiboSpot[p],f=u.avatar.split("/"),v=0,b=f.length;b>v;v++)50==f[v]&&(f[v]=180);d=p==m-1?"last":"",t=f.join("/"),i=u.icon,a=u.title,n=u.latestStatus,s=h.redurl+"?tty=1&mx="+u.metrix+"&muh="+r.imageUrlHash+"&pd="+r.widgetSid+"&ift="+u.type+"&at=&ad=&rurl="+encodeURIComponent(encodeURIComponent(u.userUrl)),c+='<li class="'+d+'"><a href="'+s+'" target="_blank" class="ins-weibo-avatar" title="'+a+'"><img src="'+t+'"/></a><div class="ins-weibo-main"><p class="name"><a href="'+s+'" target="_blank">'+a+'</a><a class="ins-weibo-icon" href="'+s+'" target="_blank"><img src="'+i+'"></a></p><p class="content">'+n+"</p></li>"}l.innerHTML=c,o.appendChild(l),e.content.appendChild(o)}},wikiApp:function(e){if(h.showWiki&&0!=e.adsData.wikiSpot.length){e.createNavItem("wiki","百科");var t,i,a,n,s=e.adsData,r=g.createElem("div"),o=g.createElem("ul"),l="",c="";r.className="content-item wiki-item",o.className="ins-wiki-list";for(var d=0,p=s.wikiSpot.length;p>d;d++){var m=s.wikiSpot[d];c=d==p-1?"last":"",t=m.firstimg||"",i=m.title,a=m.summary,n=h.redurl+"?tty=1&mx="+m.metrix+"&muh="+s.imageUrlHash+"&pd="+s.widgetSid+"&ift="+m.type+"&at=&tg="+encodeURIComponent(encodeURIComponent(i))+"&rurl="+encodeURIComponent(encodeURIComponent(m.url)),l+='<li class="'+c+'"><div class="ins-wiki-nav"><a href="'+n+'" class="avatar" title="'+i+'" target="_blank"><img src="'+t+'"/></a><p><span>'+i+'</span></p></div><div class="ins-wiki-main"><p class="summary"><span>'+a+"</span></p></li>"}o.innerHTML=l,r.appendChild(o),e.content.appendChild(r)}},newsApp:function(e){if(h.showNews){e.createNavItem("news","新闻");var t=e.adsData,i=g.createElem("div"),a=c[2*h.sizeNum],n=c[2*h.sizeNum+1],s=p+"news?size="+a+"&pd="+t.widgetSid+"&muh="+t.imageUrlHash;i.className="content-item news-item",i.innerHTML='<iframe name="weather_inc" src="'+s+'" width="'+a+'" height="'+n+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>',e.content.appendChild(i)}},wheatherApp:function(e){if(h.showWeather){e.createNavItem("weather","天气");var t=g.createElem("div"),i=c[2*h.sizeNum],a="http://www.thinkpage.cn/weather/weather.aspx?uid=&cid=101010100&l=zh-CHS&p=TWC&a=1&u=C&s=1&m=0&x=1&d=3&fc=&bgc=&bc=&ti=1&in=1&li=2&ct=iframe";t.className="content-item weather-item",t.innerHTML='<iframe name="weather_inc" src="'+a+'" width="'+i+'" height="110" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="true" ></iframe>',e.content.appendChild(t)}}};var I=function(){function e(){for(var i=0;t.length>i;i++)t[i]&&t[i].checkLocation();setTimeout(e,400)}var t=r;setTimeout(e,400)},k=function(e){e=e||0;for(var i=n.getElementsByTagName("img"),a=0,s=i.length;s>a;a++){var r=i[a];1==r.insDataLoading||r.getAttribute("instreet_data_loading")||1==r.insDataLoaded||r.getAttribute("instreet_data_loaded")||(r.insIndex===t&&(r.insIndex=o.length,o.push(r)),b(r))}5>e&&setTimeout(function(){k(++e)},1e3)},T=function(e){if(e&&"object"==typeof e)for(var t in e)h[t]=e[t]},_=function(){var t=h.cssurl;g.importFile("css",t),a=g.createElem("div"),a.className="instreet-plugin-container",u.set(a,"display","none"),n.body&&n.body.firstChild&&n.body.insertBefore(a,n.body.firstChild);var i=g.getCookie("instreet_theme");h.theme=i||0;for(var s=n.getElementsByTagName("img"),r=0,l=s.length;l>r;r++){var c=s[r];o[r]=c,c.insIndex=r,c.setAttribute("instreet_img_id",r),b(c)}I(),g.bind(e,"load",function(){k()})};m(function(){"undefined"!=typeof instreet_config&&T(instreet_config),_()})})(window);