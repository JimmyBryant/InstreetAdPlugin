(function(u,v){if(typeof u.InstreetWidget!="undefined"||u.InstreetWidget!=null){return false}else{u.InstreetWidget={version:"@REVISION@",name:"InstreetWidget"}}var z=u.document,navigator=u.navigator,location=u.location,isIE=!!u.ActiveXObject,adsObjectArray=[],imagesList=[],readyList=[],sizeList=[250,250],themeList=['red','yellow','green','blue','purple','brown'],firstImage=true,prefix="http://monkey.instreet.cn/",container;var A={redurl:prefix+"click.action",callbackurl:prefix+"push.action",murl:prefix+"tracker.action",iurl:prefix+"tracker90.action",ourl:prefix+"loadImage.action",surl:prefix+"share/weiboshare",cssurl:"css/instreet.metro.css",imih:300,imiw:300,timer:2000,sizeNum:0};var B=function(a){var b=function(){for(var i=0;i<readyList.length;i++)readyList[i]&&readyList[i]()},doScrollCheck=function(){try{z.documentElement.doScroll('left')}catch(err){setTimeout(doScrollCheck,50);return}b()};var c=!!u.ActiveXObject;if(z.readyState==="complete"){readyList.push(a);b();return}if(readyList.push(a)>1)return;if(z.addEventListener)return z.addEventListener('DOMContentLoaded',b,false);if(c){doScrollCheck()}};var C={get:function(d,e){var f=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,rnumnonpx=new RegExp("^("+f+")(?!px)[a-z%]+$","i"),rposition=/^(top|right|bottom|left)$/,ropacity=/opacity=([^)]*)/,rmargin=/^margin/;var g=function(a,b){var c=b==="width"?a.clientWidth:a.clientHeight,pt=parseFloat(C.get(a,'paddingTop')),pb=parseFloat(C.get(a,'paddingBottom')),pl=parseFloat(C.get(a,'paddingLeft')),pr=parseFloat(C.get(a,'paddingRight'));return c=(b==="width"?c-pl-pr:c-pt-pb)+'px'};if(u.getComputedStyle){var h,width,minWidth,maxWidth,computed=u.getComputedStyle(d,null),style=d.style;e=e==="float"?"cssFloat":e;if(computed){h=computed[e];if(rnumnonpx.test(h)&&rmargin.test(e)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=h;h=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return h}else if(z.documentElement.currentStyle){var i,rsLeft,h=d.currentStyle&&d.currentStyle[e],style=d.style;e=e==="float"?"styleFloat":e;if(e==='opacity'){return ropacity.test((d.currentStyle?d.currentStyle.filter:d.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":""}else if(e==="width"||e==="height"){if(d.currentStyle[e]==="auto"){return h=g(d,e)}}if(h==null&&style&&style[e]){h=style[e]}if(rnumnonpx.test(h)&&!rposition.test(e)){i=style.left;rsLeft=d.runtimeStyle&&d.runtimeStyle.left;if(rsLeft){d.runtimeStyle.left=d.currentStyle.left}style.left=e==="fontSize"?"1em":h;h=style.pixelLeft+"px";style.left=i;if(rsLeft){d.runtimeStyle.left=rsLeft}}return h===""?"auto":h}else{return d.style[e]}},set:function(a,b,c){if(typeof b=="object"&&c===v){for(var d in b){C.set(a,d,b[d])}return}if(u.getComputedStyle){b=b==="float"?"cssFloat":b}else{b=b==="float"?"styleFloat":b;if(b==="opacity"){a.style["filter"]="alpha(opacity="+100*c+")"}}a.style[b]=c}};var E=function(k){var l=[],timerId;var m=u.webkitRequestAnimationFrame||u.mozRequestAnimationFrame||u.oRequestAnimationFrame;var o=function(a){for(var b in a){return false}return true};var q=function(a){this.elem=a;return this};q.prototype.animate=function(a,b,c,d){var e=this.elem;var f=q.getOpt(b,c,d);if(e&&e.nodeType==1){var g,to;if(a&&typeof a=="object"){if(o(a)){f.callback.call(e)}else{f.animatedProperties={};for(var h in a){f.animatedProperties[h]=false}for(var i in a){var j=new r(e,f,i);g=parseFloat(C.get(e,i));end=parseFloat(a[i]);j.custom(g,end)}}}}};q.prototype.fadeIn=function(a,b,c){var _=this,k=_.elem;if(C.get(k,'display')=='none'){C.set(k,{opacity:0,display:'block'})}_.animate({opacity:1},a,b,c)};q.prototype.fadeOut=function(a,b,c){var _=this,k=_.elem;a=a||400;b=b||'swing';_.animate({opacity:0},a,b,function(){C.set(k,'display','none');c&&c()})};q.prototype.stop=function(a){var b=this.elem;a=a||false;for(var i=0;i<l.length;i--){var c=l[i];if(c.elem===b){if(a){c.update(c.name,c.end)}l.splice(i--,1)}}return this};q.getOpt=function(a,b,c){var d={};d.duration=a;d.callback=c||b||a;d.old=d.callback;d.easing=c&&b||b||a;d.callback=function(){if(typeof d.old=="function"){d.old.call(this)}};d.duration=typeof d.duration=="number"?d.duration:400;d.easing=typeof d.easing=="string"?d.easing:"swing";return d};var r=function(a,b,c){this.elem=a;this.options=b;this.name=c};r.interval=13;r.prototype.custom=function(b,c){var t,raf,self=this;this.startTime=new Date().getTime();this.start=b;this.end=c;function t(a){return self.step(a)};t.elem=this.elem;if(t()&&l.push(t)&&!timerId){if(m){timerId=true;raf=function(){if(timerId){m(raf);r.tick()}};m(raf)}else{timerId=setInterval(r.tick,r.interval)}}};r.prototype.step=function(){var a=new Date().getTime(),nowPos,done=true,options=this.options;if(a>options.duration+this.startTime){nowPos=this.end;options.animatedProperties[this.name]=true;for(i in options.animatedProperties){if(options.animatedProperties[i]!==true){done=false}}done&&options.callback.call(this.elem);this.update(this.name,nowPos);return false}else{var n=a-this.startTime;var b=n/options.duration;var c=s[options.easing](b,0,1,options.duration);nowPos=this.start+((this.end-this.start)*c)}this.update(this.name,nowPos);return true};r.prototype.update=function(a,b){if(a!="opacity"){b+="px"}C.set(this.elem,a,b)};r.tick=function(){for(var i=0;i<l.length;++i){if(!l[i]()){l.splice(i--,1)}}if(!l.length){r.stop()}};r.stop=function(){clearInterval(timerId);timerId=null};var s={linear:function(p){return p},swing:function(p){return(-Math.cos(p*Math.PI)/2)+0.5}};return new q(k)};var U={bind:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}else{a["on"+b]=c}},remove:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else if(a.datachEvent){a.datachEvent("on"+b,c)}else{a["on"+b]=null}},getEvent:function(a){return a?a:u.event},getTarget:function(a){return a.target||a.srcElement},stopPropagation:function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},getRelatedTarget:function(a){if(a.relatedTarget){return a.relatedTarget}else if(a.type=="mouseover"){return a.fromElement}else if(a.type=="mouseout"){return a.toElement}else{return null}},getXY:function(a){var x=0,y=0;if(a.getBoundingClientRect){var b=a.getBoundingClientRect();var D=z.documentElement;x=b.left+Math.max(D.scrollLeft,z.body.scrollLeft)-D.clientLeft;y=b.top+Math.max(D.scrollTop,z.body.scrollTop)-D.clientTop}else{for(;a!=z.body;x+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent){}};return{x:x,y:y}},aTrim:function(c){var d=new Array();c.sort(sortNum);var e=c.length,flag=0;for(var i=0;i<e;i++){if(c[i]!=c[i+1]){d[flag]=c[i];flag++}}return d;function sortNum(a,b){return a-b}},$:function(a){return z.getElementById(a)},$$:function(a,b,c){var d=a||z,e;if(arguments.length==2){c=b;e="*"}else{var e=b||'*'}if(z.getElementsByClassName)return d.getElementsByClassName(c);var f=[];var g=d.getElementsByTagName(e);for(var l=g.length,i=l;i--;){var h=g[i];if(h.className){var k=h.className.replace(/\s/g,'|').split('|');for(var m=k.length,j=m;j--;){if(k[j]==c){f.push(h);break}}}}return f},createElem:function(a){return z.createElement(a)},importFile:function(a,b){var c,script,head=z.getElementsByTagName("head")[0]||z.documentElement;switch(a){case"js":script=U.createElem('script');script.async="async";script.charset="utf-8";script.type="text/javascript";script.onload=script.onreadystatechange=function(){if(!script.readyState||script.readyState==="loaded"||script.readyState==="complete"){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script)}}};script.src=b;head.appendChild(script);break;case"css":c=U.createElem("link");c.type="text/css";c.rel="stylesheet";c.href=b;head.appendChild(c);break}},isVisible:function(a){if(a==z)return true;if(!a)return false;if(!a.parentNode)return false;if(a.style){if(a.style.display=='none')return false;if(a.style.visibility=='hidden')return false}if(u.getComputedStyle){var b=u.getComputedStyle(a,"");if(b.display=='none')return false;if(b.visibility=='hidden')return false}var b=a.currentStyle;if(b){if(b['display']=='none')return false;if(b['visibility']=='hidden')return false}return U.isVisible(a.parentNode)},getCookie:function(a){var b=a+"=";if(z.cookie.length>0){offset=z.cookie.indexOf(b);if(offset!=-1){offset+=b.length;end=z.cookie.indexOf(";",offset);if(end==-1)end=z.cookie.length;return unescape(z.cookie.substring(offset,end))}else return""}},setCookie:function(a,b){var c=arguments.length;var d=(c>2)?arguments[2]:null;if(d!=null){var e=new Date();e.setTime(e.getTime()+(d*1000*3600*24))}z.cookie=a+"="+escape(b)+((d==null)?"":("; expires="+e.toGMTString()))}};u['insjsonp']=function(a){if(a){var b=a.index,img=imagesList[b];img.setAttribute('instreet_data_ready',true);F(b);var c=new K(a,container);adsObjectArray[b]=c}};var F=function(a){if(adsObjectArray[a]){var _=adsObjectArray[a],parent=_.box.parentNode;parent&&parent.removeChild(_.box);parent&&parent.removeChild(_.controlBox)}};recordImage=function(a){var b=encodeURIComponent(encodeURIComponent(a.src)),pd=A.widgetSid,pu=encodeURIComponent(encodeURIComponent(u.location.href)),t=encodeURIComponent(encodeURIComponent(z.title)),ul=A.ourl;var c=new Date().getTime();ul+="?iu="+b+"&pd="+pd+"&t="+t+"&time="+c;U.importFile('js',ul)};var G=function(e){var f=function(b,c){var d=new Image();if(typeof d.src=="undefined")return;d.src=b.src;d.ins_index=b.ins_index;if(d.complete){c&&c(d)}else{d.onload=function(){var a=this;a.onload=null;c&&c(d)}}};var g=function(a){var b=a.ins_index,clientImg=imagesList[b];if(a.width>=A.imiw&&a.height>=A.imih){if(clientImg.clientWidth>=A.imiw&&clientImg.clientHeight>=A.imih){if(typeof A.adsLimit=="number"&&A.adsLimit<=0){return}recordImage(clientImg);if(typeof clientImg.naturalWidth=="undefined"||typeof clientImg.naturalHeight=="undefined"){clientImg.naturalWidth=a.width;clientImg.naturalHeight=a.height}i(clientImg);A.adsLimit&&A.adsLimit--}}};var i=function(a){var w=250,h=250;if(typeof A.sizeNum=="number"){w=sizeList[A.sizeNum*2];h=sizeList[A.sizeNum*2+1]}var b=encodeURIComponent(encodeURIComponent(a.src)),url=A.callbackurl+"?index="+a.ins_index+"&pd="+A.widgetSid+"&iu="+b+"&callback=insjsonp"+"&w="+w+"&h="+h;U.importFile('js',url)};f(e,g)};var I=function(a,b){for(var i in b){a[i]=b[i]}};var J=function(a){U.setCookie('instreet_theme',a,7);for(var i in adsObjectArray){var b=adsObjectArray[i];if(b.box&&b.box.lastChild){b.box.lastChild.className="ins-wrapper ins-"+themeList[a]+"style ins-size"+sizeList[A.sizeNum*2];b.controlBox.firstChild.className="ins-"+themeList[a]+"style";b.close.className='ins-btn-close ins-btn-'+themeList[a]+'style';var c=b.footer;var d=U.$$(c,'selected')[0];d.className="";c.getElementsByTagName('li')[a].className="selected"}}A.theme=a};var K=function(a,b){var c=imagesList[a.index];this.insIndex=a.index;this.adsData=a;this.container=b;this.image=c;this.spotsArray=[];this.timer=null;this.timerApp=null;this.isFirstShow=true;this.isOn=true;this.init()};K.fn=K.prototype;I(K.fn,{init:function(){var _=this;_.createController();_.createContainer();_.createApps();_.locate();U.bind(u,'resize',function(){_.locate()})},createController:function(){var _=this,box=U.createElem('div'),theme=U.createElem('div'),control=U.createElem('div'),share,str='';box.className='instreet-plugin-control';theme.className='ins-'+themeList[A.theme]+'style';control.className="ins-control";C.set(box,'display','none');str+='<a href="javascript:;" class="ins-icon ins-icon-control"></a><div class="ins-bubble"><dl><dt><em class="ins-arrow-top"></em></dt><dd><p>尚街已开启</p></dd></dl></div>';control.innerHTML=str;theme.appendChild(control);var c=function(e){var a=U.getEvent(e),rel=U.getRelatedTarget(a);if(!this.contains(rel)){this.timer&&clearTimeout(this.timer);E(this.lastChild).stop().fadeIn()}};var d=function(e){var a=U.getEvent(e),rel=U.getRelatedTarget(a);if(!this.contains(rel)){var b=this;b.timer=setTimeout(function(){E(b.lastChild).fadeOut()},500)}};if(A.showShareButton){share=U.createElem('div');share.className='ins-share';share.innerHTML='<a href="javascript:;" title="分享图片" class="ins-icon ins-icon-share"></a><div class="ins-bubble"><dl><dt><em class="ins-arrow-top"></em></dt><dd><a href="javascript:;" class="ins-share-sina" title="新浪微博"></a><a href="javascript:;" class="ins-share-tx" title="腾讯微博"></a><a href="javascript:;" class="ins-share-qz" title="QQ空间"></a><a href="javascript:;" class="ins-share-renren" title="人人网"></a></dd></dl></div>';theme.appendChild(share);_.share=share;share.onmouseover=c;share.onmouseout=d;share.onclick=function(e){var a=U.getEvent(e),tar=U.getTarget(a);if(tar.tagName!='A'||tar.className.indexOf('ins-share-')==-1)return;var b=encodeURIComponent(_.image.src),shareTo=tar.className.replace("ins-share-",""),widgetSid=_.adsData.widgetSid,time=new Date().getTime(),title=encodeURIComponent(z.title),url=encodeURIComponent(location.href),recordUrl=A.surl+"?content=''&imgUrl="+encodeURIComponent(b)+"&widgetSid="+widgetSid+"&pageUrl="+encodeURIComponent(location.href)+"&shareTo="+shareTo+"&time="+time,winStr="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=580, height=500";switch(tar.className){case"ins-share-sina":u.open('http://v.t.sina.com.cn/share/share.php?title='+title+'&url='+url+'&pic='+b,"_blank",winStr);break;case"ins-share-tx":u.open('http://share.v.t.qq.com/index.php?c=share&a=index&title='+title+'&url='+url+'&pic='+b,"_blank",winStr);break;case"ins-share-qz":u.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?showcount=1&url='+url+'&title='+title+'&pics='+b+'&summary=','_blank',winStr);break;case"ins-share-renren":u.open('http://share.renren.com/share/buttonshare.do?link='+url,"_blank",winStr);break}U.importFile('js',recordUrl)}}box.appendChild(theme);_.container.appendChild(box);_.controlBox=box;_.control=control;control.onmouseover=c;control.onmouseout=d;U.bind(control.firstChild,'click',function(){var p=control.getElementsByTagName('p')[0];if(_.isOn==true){K.slideIn(_);_.isOn=false;p.innerHTML='尚街已关闭'}else{K.slideOut(_);_.isOn=true;p.innerHTML='尚街已开启';_.recordShow(9)}})},createContainer:function(){var _=this,w=sizeList[A.sizeNum*2],box=U.createElem('div'),close=U.createElem('a'),wrapper=U.createElem('div'),fragment=z.createDocumentFragment(),line=U.createElem('div'),borderBox=U.createElem('div'),nav=U.createElem('ul'),content=U.createElem('div'),footer=_.createFooter();box.className="instreet-plugin-box";close.className='ins-btn-close ins-btn-'+themeList[A.theme]+'style';close.href='javascript:;';close.title='关闭广告';close.innerHTML='×';wrapper.className="ins-wrapper ins-"+themeList[A.theme]+"style ins-size"+w;C.set(box,'visibility','hidden');C.set(wrapper,'width',0);C.set(close,'display','none');line.className="ins-colorline clearfix";borderBox.className="ins-borderbox";nav.className="ins-main-nav";content.className="ins-main-content";fragment.appendChild(line);fragment.appendChild(nav);fragment.appendChild(content);fragment.appendChild(footer);borderBox.appendChild(fragment);wrapper.appendChild(borderBox);box.appendChild(close);box.appendChild(wrapper);_.container.appendChild(box);_.close=close;_.nav=nav;_.content=content;_.footer=footer;_.box=box},createApps:function(){var _=this,timer=null,box=_.box;var b=function(){var a=U.$$(_.box,'ins-colorline')[0],len=_.nav.children.length;a.className+=" ins-column"+len,str="";len=len==5?len:len==4?len:6;for(var i=0;i<len;i++){str+='<span class="'+themeList[i]+'"></span>'}a.innerHTML=str},overHandler=function(){clearTimeout(timer);if(!_.isOn){return}_.recordShow(10);K.slideOut(_)},outHandler=function(){if(!_.isOn){return}timer=setTimeout(function(){K.slideIn(_)},A.timer)};for(var i in K.apps){K.apps[i]&&K.apps[i](_)}b();U.bind(_.image,'mouseover',overHandler);U.bind(_.image,'mouseout',outHandler);U.bind(_.box,'mouseover',overHandler);U.bind(_.box,'mouseout',outHandler);U.bind(_.close,'click',function(){K.slideIn(_)});_.content.onmouseover=function(e){var a=U.getEvent(e),rel=U.getRelatedTarget(a);if(!this.contains(rel)){_.recordWatch()}};U.bind(_.controlBox,'mouseover',function(){clearTimeout(timer)});_.nav.className+=' ins-nav'+_.nav.children.length;_.content.firstChild.className+=" content-item-selected"},createNavItem:function(c,d){var _=this,li=U.createElem('li');li.className=_.nav.children.length?'nav-item':'nav-item first selected';li.innerHTML='<div><em class="icon-'+c+'"></em><span>'+d+'</span></div>';_.nav.appendChild(li);var e=null;li.onmouseover=function(){if(this.className.indexOf('selected')==-1){var b=this;e=setTimeout(function(){var a=U.$$(_.nav,'selected')[0],content=U.$$(_.content,'content-item-selected')[0],next=U.$$(_.content,c+'-item')[0],borderbox=_.nav.parentNode,wrapper=borderbox.parentNode;a.className=a.className.replace(" selected","");b.className+=" selected";E(content).stop(true).animate({'opacity':0},200,function(){this.className=this.className.replace(" content-item-selected","");next.className+=" content-item-selected";C.set(next,{'opacity':1});C.set(wrapper,'height',C.get(borderbox,'height'));_.recordShow(9)})},200)}};li.onmouseout=function(){clearTimeout(e);e=null}},createFooter:function(){var _=this,footer=U.createElem('div'),list=footer.getElementsByTagName('li');footer.className="ins-footer";footer.innerHTML='<div>powered by <a target="_blank" href="http://www.instreet.cn" title="尚街网">instreet</a><ul class="theme-list"><li><a class="red" index="0" href="javascript:;"></a></li><li><a class="yellow" index="1" href="javascript:;"></a></li><li><a class="green" index="2" href="javascript:;"></a></li><li><a class="blue" index="3" href="javascript:;"></a></li><li><a class="purple" index="4" href="javascript:;"></a></li><li><a class="brown" index="5" href="javascript:;"></a></li></ul></div>';list[A.theme].className="selected";footer.onclick=function(e){var a=U.getEvent(e),tar=U.getTarget(a);if(tar.parentNode.tagName=="LI"||tar.tagName=='LI'){var b=tar.tagName=='LI'?tar.firstChild.getAttribute("index"):tar.getAttribute("index");if(A.theme!=b){J(b)}}};return footer},locate:function(){var _=this;clearTimeout(_.timer);_.timer=setTimeout(function(){var a=_.image,pos=U.getXY(a),w=sizeList[A.sizeNum*2]+18,h=parseFloat(C.get(_.box,'height')),top=pos.y+"px",maxTop=pos.y+a.clientHeight-h,W=Math.max(z.body.clientWidth,z.documentElement.clientWidth),scrollTop=u.pageYOffset||z.documentElement.scrollTop||0;_.imageInfo={width:a.clientWidth,height:a.clientHeight,x:pos.x,y:pos.y,scrollTop:scrollTop,src:a.src};if(U.isVisible(a)&&a.clientWidth>=A.imiw&&a.clientHeight>=A.imih){C.set(_.controlBox,{top:(pos.y+5)+'px',left:(pos.x+5)+'px','display':'block'});C.set(_.box,'visibility','visible')}else{C.set(_.controlBox,'display','none');C.set(_.box,'visibility','hidden')}if(scrollTop>maxTop){top=maxTop+"px"}else if(pos.y<scrollTop&&scrollTop<=maxTop){top=scrollTop+"px"}if(W<(pos.x+a.clientWidth+w)){var b=(W-pos.x-a.clientWidth)+"px";C.set(_.box,{'top':top,'right':b,'left':'auto'});C.set(_.box.lastChild.lastChild,{left:0,right:'auto'})}else{var c=(pos.x+a.offsetWidth)+"px";C.set(_.box,{'top':top,'left':c,'right':'auto'});C.set(_.box.lastChild.lastChild,{left:'auto',right:0})}if(A.footAuto&&_.isFirstShow){_.recordShow(9);K.slideOut(_);_.isFirstShow=false}},100)},checkLocation:function(){var _=this,img=_.image,pos=U.getXY(img),info=_.imageInfo,scrollTop=u.pageYOffset||z.documentElement.scrollTop||0;if(typeof info=="undefined"){return}if(img.clientWidth<=0||img.clientHeight<=0){var a=z.images;for(var i=a.length;i--;){if(a[i].src==img.src&&a[i].clientWidth>=A.imiw&&a[i].clientHeight>=A.imih){_.image=a[i];_.locate();return}}_.locate()}else if(typeof img.src!="undefined"&&img.src!=info.src){info.src=img.src;F(_.insIndex);typeof A.adsLimit=='number'&&A.adsLimit++;G(img)}else if(pos.x!==info.x||pos.y!==info.y||scrollTop!==info.scrollTop||img.clientWidth!==info.width||img.clientHeight!==info.height){_.locate()}},recordShow:function(a){var _=this,data=_.adsData,img=_.image,ul=A.iurl,pd=data.widgetSid,muh=data.imageUrlHash,iu=encodeURIComponent(encodeURIComponent(img.src)),adsId="",adsType="",index=0,mx='',time=new Date().getTime(),w=parseFloat(_.box.lastChild.style.width);if(a==10&&w>0)return;var b=U.$$(_.content,'content-item-selected')[0];if(b){if(b.className.indexOf('ad-item')!=-1){var c=data.badsSpot[0];adsId=c.adsId;adsType=c.adsType;c.adViewMonitorUrl&&U.importFile('js',c.adViewMonitorUrl+'?time='+time)}else if(b.className.indexOf('shop-item')!=-1){index=_.getSelectedIndex();var c=data.adsSpot[index];adsId=c.adsId;adsType=c.adsType;mx=c.metrix}else if(a==9){return}}else if(a==9){return}ul+="?pd="+pd+"&mx="+mx+"&muh="+muh+"&iu="+iu+"&ad="+adsId+"&at="+adsType+"&flag="+a+"&time="+time;U.importFile('js',ul)},recordWatch:function(){var _=this,data=_.adsData,img=_.image,iu=encodeURIComponent(encodeURIComponent(img.src)),pd=data.widgetSid,url=A.murl,mid=data.imageNumId||'',muh=data.imageUrlHash,adData,ad='',at='',tg='',ift=0,tty=1,mx='';var a=U.$$(_.content,'content-item-selected')[0],cn=a.className;if(cn.indexOf('shop-item')!=-1){var b=_.getSelectedIndex(),app=data.adsSpot[b];ad=app.adsId;at=app.adsType;mx=app.metrix;tty=0}else if(cn.indexOf('ad-item')!=-1){ad=data.badsSpot[0].adsId;at=data.badsSpot[0].adsType;tty=0}else if(cn.indexOf('weibo-item')!=-1){ift=2}else if(cn.indexOf('wiki-item')!=-1){ift=4}else if(cn.indexOf('weather-item')!=-1){ift=7}else if(cn.indexOf('news-item')!=-1){ift=5}else{return}var c=new Date().getTime();url+="?iu="+iu+"&mx="+mx+"&pd="+pd+"&muh="+muh+"&ad="+ad+"&at="+at+"&tty="+tty+"&ift="+ift+"&time="+c;U.importFile('js',url)},getSelectedIndex:function(){var _=this,slider=U.$$(_.content,'slider-nav')[0],selected;selected=slider&&U.$$(slider,'selected')[0];if(!selected)return 0;else return selected.getAttribute("index")}});K.slideOut=function(a){var _=a,box=_.box,wrapper=box.lastChild,borderbox=wrapper.lastChild,w=parseFloat(C.get(wrapper,'width')),W=C.get(borderbox,'width'),H=C.get(borderbox,'height');E(_.control.firstChild).fadeIn();_.share&&E(_.share.firstChild).fadeIn();if(w<=0){C.set(wrapper,'height',H);E(wrapper).animate({width:W},300,function(){C.set(box.firstChild,'display','block')})}};K.slideIn=function(a){var _=a,box=_.box,wrapper=box.lastChild;E(_.control.firstChild).animate({opacity:0.7});_.share&&E(_.share.firstChild).fadeOut();E(wrapper).animate({width:0},function(){C.set(box.firstChild,'display','none')})};K.apps={adApp:function(a){if(!A.showFootAd||a.adsData.badsSpot.length==0)return;a.createNavItem('ad','推广');var b=a.adsData,app=b.badsSpot[0],ad=U.createElem('div'),redUrl,str="",w=sizeList[A.sizeNum*2],h=sizeList[A.sizeNum*2+1];ad.className="content-item ad-item";if(app.adClickMonitorUrl){var c=app.adClickMonitorUrl+encodeURIComponent(encodeURIComponent(app.adsLinkUrl||''));redUrl=A.redurl+"?tty=0&mx=&muh="+b.imageUrlHash+"&pd="+b.widgetSid+"&ift=&at="+(app.adsType||'')+"&ad="+(app.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(c))}else{redUrl=A.redurl+"?tty=0&mx=&muh="+b.imageUrlHash+"&pd="+b.widgetSid+"&ift=&at="+(app.adsType||'')+"&ad="+(app.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(app.adsLinkUrl||''))}if(app.adsType==3){str='<a class="ad-thumb" target="_blank" href="'+redUrl+'"><img src="'+app.adsPicUrl+'" alt=""/></a>'}else if(app.adsType==9){str+='<object id="afg-adloader" width="'+w+'" height="'+h+'"  align="middle" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">';str+='<param value="always" name="allowScriptAccess"/><param value="'+app.adsPicUrl+'" name="movie"/><param value="high" name="quality"/><param value="opaque" name="wmode"/><param value="high" name="quality"><param value="#F1F1F1" name="bgcolor"/>';str+='<embed width="'+w+'" height="'+h+'" align="middle" pluginspage="http://www.adobe.com/go/getflashplayer"  type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque"  bgcolor="#F1F1F1" quality="high" src="'+app.adsPicUrl+'"></object>';str+='<a class="ad-flashcover" href="'+redUrl+'" target="_blank"></a>'}else if(!app.adsLinkUrl&&app.description){var d='<iframe src="'+app.description+'" scrolling="no" height="'+app.adsHeight+'" width="'+app.adsWidth+'" frameborder="0" border="0" marginwidth="0" marginheight="0"></iframe>';str+='<i class="small-info"></i>'+d}ad.innerHTML=str;a.content.appendChild(ad)},shopApp:function(c){if(!A.showAd||c.adsData.adsSpot.length==0)return;c.createNavItem('shop','折扣');var d=c.adsData,shop=U.createElem('div'),list=U.createElem('div'),slider=U.createElem('ul'),redUrl,title,price,imgUrl,nick,app;shop.className="content-item shop-item";list.className="album-list";slider.className="slider-nav";for(var i=0,len=d.adsSpot.length;i<len;i++){var f=U.createElem("a");app=d.adsSpot[i];redUrl=A.redurl+"?tty=0&mx="+app.metrix+"&muh="+d.imageUrlHash+"&pd="+app.widgetSid+"&ift=&at="+app.adsType+"&ad="+app.adsId+"&rurl="+encodeURIComponent(encodeURIComponent(app.adsLinkUrl));title=app.adsTitle;nick=app.nick;price=app.adsDiscount||app.adsPrice;imgUrl=app.adsPicUrl.replace("160x160",sizeList[A.sizeNum*2]+"x"+sizeList[A.sizeNum*2]);f.className="product-album";f.target="_blank";f.href=redUrl;f.innerHTML='<img alt="'+title+'" src="'+imgUrl+'"><span class="product-info"><em class="price">￥'+price+'</em><em class="name">'+title+'</em><em class="nick">'+nick+'</em>';if(len>1){slider.innerHTML+='<li class="switch-trigger" index="'+i+'"></li>'}list.appendChild(f)}shop.appendChild(list);shop.appendChild(slider);list.firstChild.className+=" selected";if(slider.firstChild)slider.firstChild.className+=" selected";c.content.appendChild(shop);slider.onmouseover=function(e){var a=U.getEvent(e),tar=U.getTarget(a),selected=U.$$(this,'selected')[0],w=parseFloat(C.get(list.firstChild,'width'));if(tar.className=="switch-trigger"){selected.className="switch-trigger";tar.className+=" selected";var b=-parseInt(tar.getAttribute("index"))*w;E(list).animate({'left':b},function(){c.recordWatch()})}}},weiboApp:function(a){if(!A.showWeibo||a.adsData.weiboSpot.length==0)return;a.createNavItem('weibo','微博');var b=a.adsData,weibo=U.createElem("div"),list=U.createElem('ul'),str="",avatar,icon,title,article,redUrl,cn='';weibo.className="content-item weibo-item";list.className="ins-weibo-list";for(var i=0,len=b.weiboSpot.length;i<len;i++){var c=b.weiboSpot[i],arr=c.avatar.split('/');for(var j=0,l=arr.length;j<l;j++){if(arr[j]==50)arr[j]=180}cn=i==len-1?'last':'';avatar=arr.join('/');icon=c.icon;title=c.title;article=c.latestStatus;redUrl=A.redurl+"?tty=1&mx="+c.metrix+"&muh="+b.imageUrlHash+"&pd="+b.widgetSid+"&ift="+c.type+"&at=&ad=&rurl="+encodeURIComponent(encodeURIComponent(c.userUrl));str+='<li class="'+cn+'"><a href="'+redUrl+'" target="_blank" class="ins-weibo-avatar" title="'+title+'"><img src="'+avatar+'"/></a><div class="ins-weibo-main"><p class="name"><a href="'+redUrl+'" target="_blank">'+title+'</a><a class="ins-weibo-icon" href="'+redUrl+'" target="_blank"><img src="'+icon+'"></a></p><p class="content">'+article+'</p></li>'}list.innerHTML=str;weibo.appendChild(list);a.content.appendChild(weibo)},wikiApp:function(a){if(!A.showWiki||a.adsData.wikiSpot.length==0)return;a.createNavItem('wiki','百科');var b=a.adsData,wiki=U.createElem("div"),list=U.createElem('ul'),str="",avatar,title,article,redUrl,cn='';wiki.className="content-item wiki-item";list.className="ins-wiki-list";for(var i=0,len=b.wikiSpot.length;i<len;i++){var c=b.wikiSpot[i];cn=i==len-1?'last':'';avatar=c.firstimg||"";title=c.title;article=c.summary;redUrl=A.redurl+"?tty=1&mx="+c.metrix+"&muh="+b.imageUrlHash+"&pd="+b.widgetSid+"&ift="+c.type+"&at=&tg="+encodeURIComponent(encodeURIComponent(title))+"&rurl="+encodeURIComponent(encodeURIComponent(c.url));str+='<li class="'+cn+'"><div class="ins-wiki-nav"><a href="'+redUrl+'" class="avatar" title="'+title+'" target="_blank"><img src="'+avatar+'"/></a><p><span>'+title+'</span></p></div><div class="ins-wiki-main"><p class="summary"><span>'+article+'</span></p></li>'}list.innerHTML=str;wiki.appendChild(list);a.content.appendChild(wiki)},newsApp:function(a){if(!A.showNews)return;a.createNavItem('news','新闻');var b=a.adsData,news=U.createElem('div'),w=sizeList[A.sizeNum*2],h=sizeList[A.sizeNum*2+1],newsUrl=prefix+"news?size="+w+"&pd="+b.widgetSid+"&muh="+b.imageUrlHash;news.className="content-item news-item";news.innerHTML='<iframe name="weather_inc" src="'+newsUrl+'" width="'+w+'" height="'+h+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>';a.content.appendChild(news)},wheatherApp:function(a){if(!A.showWeather)return;a.createNavItem('weather','天气');var b=U.createElem("div"),w=sizeList[A.sizeNum*2],weatherUrl="http://www.thinkpage.cn/weather/weather.aspx?uid=&cid=101010100&l=zh-CHS&p=TWC&a=1&u=C&s=1&m=0&x=1&d=3&fc=&bgc=&bc=&ti=1&in=1&li=2&ct=iframe";b.className="content-item weather-item";b.innerHTML='<iframe name="weather_inc" src="'+weatherUrl+'" width="'+w+'" height="110" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="true" ></iframe>';a.content.appendChild(b)}};var L=function(){var a=adsObjectArray;function loop(){for(var i=0;i<a.length;i++){a[i]&&a[i].checkLocation()}setTimeout(loop,400)};setTimeout(loop,400)};var M=function(c){if(c&&typeof c=="object"){for(var i in c){A[i]=c[i]}}else{return}};var N=function(){var a=A.cssurl;U.importFile('css',a);container=U.createElem("div");container.className="instreet-plugin-container";C.set(container,'display','none');z.body&&z.body.firstChild&&z.body.insertBefore(container,z.body.firstChild);var b=U.getCookie('instreet_theme');A.theme=b||0;var c=z.getElementsByTagName('img');for(var i=0,len=c.length;i<len;i++){var d=c[i];imagesList[i]=d;d.ins_index=i;d.setAttribute("instreet_img_id",i);G(d)}L()};B(function(){if(typeof instreet_config!="undefined"){M(instreet_config)}N()})})(window);